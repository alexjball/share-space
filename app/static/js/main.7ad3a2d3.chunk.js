(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],[,,,,,,,,function(e,t,i){},,,function(e,t,i){e.exports=i(20)},,,,,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},writable:!0,configurable:!0}),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,"function"!==typeof window.CustomEvent&&(window.CustomEvent=e)}()},function(e,t,i){"use strict";i.r(t);var s=i(0),n=i.n(s),r=i(10),a=i.n(r),o=(i(16),i(1)),h=i(2),c=i(4),u=i(3),l=i(5),d=(i(17),i(18),function(e){function t(e){var i;return Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={open:!!e.initiallyOpen,roomServer:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_DEFAULT_ROOM_SERVER||"localhost:3001",roomCode:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_DEFAULT_ROOM_CODE||"share-space"},i.clickId=0,i}return Object(l.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.connect||function(){};return n.a.createElement("div",{className:"control-container"},n.a.createElement("div",{className:"control-panel center ".concat(this.state.open?"":"hidden")},n.a.createElement("div",{className:"item"},"Room server:"),n.a.createElement("input",{className:"item",type:"text",value:this.state.roomServer,onChange:function(t){return e.setState({roomServer:t.target.value})}}),n.a.createElement("div",{className:"item"},"Room code:"),n.a.createElement("input",{className:"item",type:"password",value:this.state.roomCode,onChange:function(t){return e.setState({roomCode:t.target.value})}}),n.a.createElement("button",{className:"item",onClick:function(){return t({roomServer:e.state.roomServer,roomCode:e.state.roomCode,key:e.clickId++})}},"Connect"),Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_VNC_SERVER&&n.a.createElement("button",{className:"item",onClick:function(){return window.open(Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_VNC_SERVER)}},"Open VNC")))}}]),t}(s.Component)),_=(i(8),function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wss";switch(Object(o.a)(this,e),this.roomServer=t,i){case"http":case"ws":this.protocol={ws:"ws",http:"http"};break;case"https":case"wss":this.protocol={ws:"wss",http:"https"};break;default:throw Error("Invalid protocol ".concat(i))}}return Object(h.a)(e,[{key:"openStream",value:function(){var e=new WebSocket("".concat(this.protocol.ws,"://").concat(this.roomServer,"/stream"));return e.binaryType="arraybuffer",e}},{key:"getControlUrl",value:function(){return"".concat(this.protocol.ws,"://").concat(this.roomServer,"/control")}},{key:"logIn",value:function(e){return fetch("".concat(this.protocol.http,"://").concat(this.roomServer,"/login"),{method:"POST",body:"username=client&password=".concat(e),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){if(200!==e.status)throw Error("Login error ".concat(e.status));return e.json()}))}},{key:"testAuth",value:function(){return fetch("".concat(this.protocol.http,"://").concat(this.roomServer,"/test"),{method:"GET",credentials:"include"})}}]),e}()),f=i(6),v="warn",p=function(){},m=function(){},g=function(){},y=function(){};function k(e){return decodeURIComponent(escape(e))}!function(e){if("undefined"===typeof e?e=v:v=e,p=m=g=y=function(){},"undefined"!==typeof window.console)switch(e){case"debug":p=console.debug.bind(window.console);case"info":m=console.info.bind(window.console);case"warn":g=console.warn.bind(window.console);case"error":y=console.error.bind(window.console);case"none":break;default:throw new window.Error("invalid logging type '"+e+"'")}}();var w="ontouchstart"in document.documentElement||void 0!==document.ontouchstart||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;window.addEventListener("touchstart",(function e(){w=!0,window.removeEventListener("touchstart",e,!1)}),!1);var b=10*(window.devicePixelRatio||1),E=!1;try{var C=document.createElement("canvas");C.style.cursor='url("data:image/x-icon;base64,AAACAAEACAgAAAIAAgA4AQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAAAAAAAAAAAAAAAAAAAA==") 2 2, default',0===C.style.cursor.indexOf("url")?(m("Data URI scheme cursor supported"),E=!0):g("Data URI scheme cursor not supported")}catch(oa){y("Data URI scheme cursor test exception: "+oa)}var S=E,Q=!1;try{new ImageData(new Uint8ClampedArray(4),1,1),Q=!0}catch(ha){}var x=Q;function A(){return navigator&&!!/mac/i.exec(navigator.platform)}function F(){return navigator&&!!/win/i.exec(navigator.platform)}function D(){return navigator&&!!/trident/i.exec(navigator.userAgent)}function B(){return navigator&&!!/edge/i.exec(navigator.userAgent)}function R(){return navigator&&!!/firefox/i.exec(navigator.userAgent)}var L=function(){function e(){Object(o.a)(this,e),this._listeners=new Map}return Object(h.a)(e,[{key:"addEventListener",value:function(e,t){this._listeners.has(e)||this._listeners.set(e,new Set),this._listeners.get(e).add(t)}},{key:"removeEventListener",value:function(e,t){this._listeners.has(e)&&this._listeners.get(e).delete(t)}},{key:"dispatchEvent",value:function(e){var t=this;return!this._listeners.has(e.type)||(this._listeners.get(e.type).forEach((function(i){return i.call(t,e)})),!e.defaultPrevented)}}]),e}(),T={toBase64Table:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),base64Pad:"=",encode:function(e){for(var t="",i=e.length,s=i%3,n=0;n<i-2;n+=3)t+=this.toBase64Table[e[n]>>2],t+=this.toBase64Table[((3&e[n])<<4)+(e[n+1]>>4)],t+=this.toBase64Table[((15&e[n+1])<<2)+(e[n+2]>>6)],t+=this.toBase64Table[63&e[n+2]];var r=i-s;return 2===s?(t+=this.toBase64Table[e[r]>>2],t+=this.toBase64Table[((3&e[r])<<4)+(e[r+1]>>4)],t+=this.toBase64Table[(15&e[r+1])<<2],t+=this.toBase64Table[64]):1===s&&(t+=this.toBase64Table[e[r]>>2],t+=this.toBase64Table[(3&e[r])<<4],t+=this.toBase64Table[64],t+=this.toBase64Table[64]),t},toBinaryTable:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],decode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.indexOf("=")-t;i<0&&(i=e.length-t);for(var s=3*(i>>2)+Math.floor(i%4/1.5),n=new Array(s),r=0,a=0,o=0,h=t;h<e.length;h++){var c=this.toBinaryTable[127&e.charCodeAt(h)],u=e.charAt(h)===this.base64Pad;-1!==c?(a=a<<6|c,(r+=6)>=8&&(r-=8,u||(n[o++]=a>>r&255),a&=(1<<r)-1)):y("Illegal character code "+e.charCodeAt(h)+" at position "+h)}if(r){var l=new Error("Corrupted base64 string");throw l.name="Base64-Error",l}return n}},M=function(){function e(t){if(Object(o.a)(this,e),this._drawCtx=null,this._c_forceCanvas=!1,this._renderQ=[],this._flushing=!1,this._fb_width=0,this._fb_height=0,this._prevDrawStyle="",this._tile=null,this._tile16x16=null,this._tile_x=0,this._tile_y=0,p(">> Display.constructor"),this._target=t,!this._target)throw new Error("Target must be set");if("string"===typeof this._target)throw new Error("target must be a DOM element");if(!this._target.getContext)throw new Error("no getContext method");if(this._targetCtx=this._target.getContext("2d"),this._viewportLoc={x:0,y:0,w:this._target.width,h:this._target.height},this._backbuffer=document.createElement("canvas"),this._drawCtx=this._backbuffer.getContext("2d"),this._damageBounds={left:0,top:0,right:this._backbuffer.width,bottom:this._backbuffer.height},p("User Agent: "+navigator.userAgent),!("createImageData"in this._drawCtx))throw new Error("Canvas does not support createImageData");this._tile16x16=this._drawCtx.createImageData(16,16),p("<< Display.constructor"),this._scale=1,this._clipViewport=!1,this.onflush=function(){}}return Object(h.a)(e,[{key:"viewportChangePos",value:function(e,t){var i=this._viewportLoc;e=Math.floor(e),t=Math.floor(t),this._clipViewport||(e=-i.w,t=-i.h);var s=i.x+i.w-1,n=i.y+i.h-1;e<0&&i.x+e<0&&(e=-i.x),s+e>=this._fb_width&&(e-=s+e-this._fb_width+1),i.y+t<0&&(t=-i.y),n+t>=this._fb_height&&(t-=n+t-this._fb_height+1),0===e&&0===t||(p("viewportChange deltaX: "+e+", deltaY: "+t),i.x+=e,i.y+=t,this._damage(i.x,i.y,i.w,i.h),this.flip())}},{key:"viewportChangeSize",value:function(e,t){this._clipViewport&&"undefined"!==typeof e&&"undefined"!==typeof t||(p("Setting viewport to full display region"),e=this._fb_width,t=this._fb_height),e=Math.floor(e),t=Math.floor(t),e>this._fb_width&&(e=this._fb_width),t>this._fb_height&&(t=this._fb_height);var i=this._viewportLoc;if(i.w!==e||i.h!==t){i.w=e,i.h=t;var s=this._target;s.width=e,s.height=t,this.viewportChangePos(0,0),this._damage(i.x,i.y,i.w,i.h),this.flip(),this._rescale(this._scale)}}},{key:"absX",value:function(e){return 0===this._scale?0:e/this._scale+this._viewportLoc.x}},{key:"absY",value:function(e){return 0===this._scale?0:e/this._scale+this._viewportLoc.y}},{key:"resize",value:function(e,t){this._prevDrawStyle="",this._fb_width=e,this._fb_height=t;var i=this._backbuffer;if(i.width!==e||i.height!==t){var s=null;i.width>0&&i.height>0&&(s=this._drawCtx.getImageData(0,0,i.width,i.height)),i.width!==e&&(i.width=e),i.height!==t&&(i.height=t),s&&this._drawCtx.putImageData(s,0,0)}var n=this._viewportLoc;this.viewportChangeSize(n.w,n.h),this.viewportChangePos(0,0)}},{key:"_damage",value:function(e,t,i,s){e<this._damageBounds.left&&(this._damageBounds.left=e),t<this._damageBounds.top&&(this._damageBounds.top=t),e+i>this._damageBounds.right&&(this._damageBounds.right=e+i),t+s>this._damageBounds.bottom&&(this._damageBounds.bottom=t+s)}},{key:"flip",value:function(e){if(0===this._renderQ.length||e){var t=this._damageBounds.left,i=this._damageBounds.top,s=this._damageBounds.right-t,n=this._damageBounds.bottom-i,r=t-this._viewportLoc.x,a=i-this._viewportLoc.y;r<0&&(s+=r,t-=r,r=0),a<0&&(n+=a,i-=a,a=0),r+s>this._viewportLoc.w&&(s=this._viewportLoc.w-r),a+n>this._viewportLoc.h&&(n=this._viewportLoc.h-a),s>0&&n>0&&this._targetCtx.drawImage(this._backbuffer,t,i,s,n,r,a,s,n),this._damageBounds.left=this._damageBounds.top=65535,this._damageBounds.right=this._damageBounds.bottom=0}else this._renderQ_push({type:"flip"})}},{key:"pending",value:function(){return this._renderQ.length>0}},{key:"flush",value:function(){0===this._renderQ.length?this.onflush():this._flushing=!0}},{key:"fillRect",value:function(e,t,i,s,n,r){0===this._renderQ.length||r?(this._setFillColor(n),this._drawCtx.fillRect(e,t,i,s),this._damage(e,t,i,s)):this._renderQ_push({type:"fill",x:e,y:t,width:i,height:s,color:n})}},{key:"copyImage",value:function(e,t,i,s,n,r,a){0===this._renderQ.length||a?(this._drawCtx.mozImageSmoothingEnabled=!1,this._drawCtx.webkitImageSmoothingEnabled=!1,this._drawCtx.msImageSmoothingEnabled=!1,this._drawCtx.imageSmoothingEnabled=!1,this._drawCtx.drawImage(this._backbuffer,e,t,n,r,i,s,n,r),this._damage(i,s,n,r)):this._renderQ_push({type:"copy",old_x:e,old_y:t,x:i,y:s,width:n,height:r})}},{key:"imageRect",value:function(e,t,i,s){var n=new Image;n.src="data: "+i+";base64,"+T.encode(s),this._renderQ_push({type:"img",img:n,x:e,y:t})}},{key:"startTile",value:function(e,t,i,s,n){this._tile_x=e,this._tile_y=t,this._tile=16===i&&16===s?this._tile16x16:this._drawCtx.createImageData(i,s);for(var r=n[2],a=n[1],o=n[0],h=this._tile.data,c=0;c<i*s*4;c+=4)h[c]=r,h[c+1]=a,h[c+2]=o,h[c+3]=255}},{key:"subTile",value:function(e,t,i,s,n){for(var r=n[2],a=n[1],o=n[0],h=e+i,c=t+s,u=this._tile.data,l=this._tile.width,d=t;d<c;d++)for(var _=e;_<h;_++){var f=4*(_+d*l);u[f]=r,u[f+1]=a,u[f+2]=o,u[f+3]=255}}},{key:"finishTile",value:function(){this._drawCtx.putImageData(this._tile,this._tile_x,this._tile_y),this._damage(this._tile_x,this._tile_y,this._tile.width,this._tile.height)}},{key:"blitImage",value:function(e,t,i,s,n,r,a){if(0===this._renderQ.length||a)this._bgrxImageData(e,t,i,s,n,r);else{var o=new Uint8Array(i*s*4);o.set(new Uint8Array(n.buffer,0,o.length)),this._renderQ_push({type:"blit",data:o,x:e,y:t,width:i,height:s})}}},{key:"blitRgbImage",value:function(e,t,i,s,n,r,a){if(0===this._renderQ.length||a)this._rgbImageData(e,t,i,s,n,r);else{var o=new Uint8Array(i*s*3);o.set(new Uint8Array(n.buffer,0,o.length)),this._renderQ_push({type:"blitRgb",data:o,x:e,y:t,width:i,height:s})}}},{key:"blitRgbxImage",value:function(e,t,i,s,n,r,a){if(0===this._renderQ.length||a)this._rgbxImageData(e,t,i,s,n,r);else{var o=new Uint8Array(i*s*4);o.set(new Uint8Array(n.buffer,0,o.length)),this._renderQ_push({type:"blitRgbx",data:o,x:e,y:t,width:i,height:s})}}},{key:"drawImage",value:function(e,t,i){this._drawCtx.drawImage(e,t,i),this._damage(t,i,e.width,e.height)}},{key:"autoscale",value:function(e,t){var i;if(0===e||0===t)i=0;else{var s=this._viewportLoc,n=e/t;i=s.w/s.h>=n?e/s.w:t/s.h}this._rescale(i)}},{key:"_rescale",value:function(e){this._scale=e;var t=this._viewportLoc,i=e*t.w+"px",s=e*t.h+"px";this._target.style.width===i&&this._target.style.height===s||(this._target.style.width=i,this._target.style.height=s)}},{key:"_setFillColor",value:function(e){var t="rgb("+e[2]+","+e[1]+","+e[0]+")";t!==this._prevDrawStyle&&(this._drawCtx.fillStyle=t,this._prevDrawStyle=t)}},{key:"_rgbImageData",value:function(e,t,i,s,n,r){for(var a=this._drawCtx.createImageData(i,s),o=a.data,h=0,c=r;h<i*s*4;h+=4,c+=3)o[h]=n[c],o[h+1]=n[c+1],o[h+2]=n[c+2],o[h+3]=255;this._drawCtx.putImageData(a,e,t),this._damage(e,t,a.width,a.height)}},{key:"_bgrxImageData",value:function(e,t,i,s,n,r){for(var a=this._drawCtx.createImageData(i,s),o=a.data,h=0,c=r;h<i*s*4;h+=4,c+=4)o[h]=n[c+2],o[h+1]=n[c+1],o[h+2]=n[c],o[h+3]=255;this._drawCtx.putImageData(a,e,t),this._damage(e,t,a.width,a.height)}},{key:"_rgbxImageData",value:function(e,t,i,s,n,r){var a;x?a=new ImageData(new Uint8ClampedArray(n.buffer,n.byteOffset,i*s*4),i,s):(a=this._drawCtx.createImageData(i,s)).data.set(new Uint8ClampedArray(n.buffer,n.byteOffset,i*s*4)),this._drawCtx.putImageData(a,e,t),this._damage(e,t,a.width,a.height)}},{key:"_renderQ_push",value:function(e){this._renderQ.push(e),1===this._renderQ.length&&this._scan_renderQ()}},{key:"_resume_renderQ",value:function(){this.removeEventListener("load",this._noVNC_display._resume_renderQ),this._noVNC_display._scan_renderQ()}},{key:"_scan_renderQ",value:function(){for(var e=!0;e&&this._renderQ.length>0;){var t=this._renderQ[0];switch(t.type){case"flip":this.flip(!0);break;case"copy":this.copyImage(t.old_x,t.old_y,t.x,t.y,t.width,t.height,!0);break;case"fill":this.fillRect(t.x,t.y,t.width,t.height,t.color,!0);break;case"blit":this.blitImage(t.x,t.y,t.width,t.height,t.data,0,!0);break;case"blitRgb":this.blitRgbImage(t.x,t.y,t.width,t.height,t.data,0,!0);break;case"blitRgbx":this.blitRgbxImage(t.x,t.y,t.width,t.height,t.data,0,!0);break;case"img":t.img.complete?this.drawImage(t.img,t.x,t.y):(t.img._noVNC_display=this,t.img.addEventListener("load",this._resume_renderQ),e=!1)}e&&this._renderQ.shift()}0===this._renderQ.length&&this._flushing&&(this._flushing=!1,this.onflush())}},{key:"scale",get:function(){return this._scale},set:function(e){this._rescale(e)}},{key:"clipViewport",get:function(){return this._clipViewport},set:function(e){this._clipViewport=e;var t=this._viewportLoc;this.viewportChangeSize(t.w,t.h),this.viewportChangePos(0,0)}},{key:"width",get:function(){return this._fb_width}},{key:"height",get:function(){return this._fb_height}}]),e}();function U(e){e.stopPropagation(),e.preventDefault()}var O=!1,I=null;function P(e){if(!O){var t=new e.constructor(e.type,e);O=!0,document.captureElement?document.captureElement.dispatchEvent(t):I.dispatchEvent(t),O=!1,e.stopPropagation(),t.defaultPrevented&&e.preventDefault(),"mouseup"===e.type&&H()}}function N(){document.getElementById("noVNC_mouse_capture_elem").style.cursor=window.getComputedStyle(document.captureElement).cursor}document.captureElement=null;var K=new MutationObserver(N);function H(){if(document.releaseCapture)document.releaseCapture(),document.captureElement=null;else{if(!document.captureElement)return;I=document.captureElement,document.captureElement=null,K.disconnect(),document.getElementById("noVNC_mouse_capture_elem").style.display="none",window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",P)}}var j={256:960,257:992,258:451,259:483,260:417,261:433,262:454,263:486,264:710,265:742,266:709,267:741,268:456,269:488,270:463,271:495,272:464,273:496,274:938,275:954,278:972,279:1004,280:458,281:490,282:460,283:492,284:728,285:760,286:683,287:699,288:725,289:757,290:939,291:955,292:678,293:694,294:673,295:689,296:933,297:949,298:975,299:1007,302:967,303:999,304:681,305:697,308:684,309:700,310:979,311:1011,312:930,313:453,314:485,315:934,316:950,317:421,318:437,321:419,322:435,323:465,324:497,325:977,326:1009,327:466,328:498,330:957,331:959,332:978,333:1010,336:469,337:501,338:5052,339:5053,340:448,341:480,342:931,343:947,344:472,345:504,346:422,347:438,348:734,349:766,350:426,351:442,352:425,353:441,354:478,355:510,356:427,357:443,358:940,359:956,360:989,361:1021,362:990,363:1022,364:733,365:765,366:473,367:505,368:475,369:507,370:985,371:1017,376:5054,377:428,378:444,379:431,380:447,381:430,382:446,402:2294,466:16777681,711:439,728:418,729:511,731:434,733:445,901:1966,902:1953,904:1954,905:1955,906:1956,908:1959,910:1960,911:1963,912:1974,913:1985,914:1986,915:1987,916:1988,917:1989,918:1990,919:1991,920:1992,921:1993,922:1994,923:1995,924:1996,925:1997,926:1998,927:1999,928:2e3,929:2001,931:2002,932:2004,933:2005,934:2006,935:2007,936:2008,937:2009,938:1957,939:1961,940:1969,941:1970,942:1971,943:1972,944:1978,945:2017,946:2018,947:2019,948:2020,949:2021,950:2022,951:2023,952:2024,953:2025,954:2026,955:2027,956:2028,957:2029,958:2030,959:2031,960:2032,961:2033,962:2035,963:2034,964:2036,965:2037,966:2038,967:2039,968:2040,969:2041,970:1973,971:1977,972:1975,973:1976,974:1979,1025:1715,1026:1713,1027:1714,1028:1716,1029:1717,1030:1718,1031:1719,1032:1720,1033:1721,1034:1722,1035:1723,1036:1724,1038:1726,1039:1727,1040:1761,1041:1762,1042:1783,1043:1767,1044:1764,1045:1765,1046:1782,1047:1786,1048:1769,1049:1770,1050:1771,1051:1772,1052:1773,1053:1774,1054:1775,1055:1776,1056:1778,1057:1779,1058:1780,1059:1781,1060:1766,1061:1768,1062:1763,1063:1790,1064:1787,1065:1789,1066:1791,1067:1785,1068:1784,1069:1788,1070:1760,1071:1777,1072:1729,1073:1730,1074:1751,1075:1735,1076:1732,1077:1733,1078:1750,1079:1754,1080:1737,1081:1738,1082:1739,1083:1740,1084:1741,1085:1742,1086:1743,1087:1744,1088:1746,1089:1747,1090:1748,1091:1749,1092:1734,1093:1736,1094:1731,1095:1758,1096:1755,1097:1757,1098:1759,1099:1753,1100:1752,1101:1756,1102:1728,1103:1745,1105:1699,1106:1697,1107:1698,1108:1700,1109:1701,1110:1702,1111:1703,1112:1704,1113:1705,1114:1706,1115:1707,1116:1708,1118:1710,1119:1711,1168:1725,1169:1709,1488:3296,1489:3297,1490:3298,1491:3299,1492:3300,1493:3301,1494:3302,1495:3303,1496:3304,1497:3305,1498:3306,1499:3307,1500:3308,1501:3309,1502:3310,1503:3311,1504:3312,1505:3313,1506:3314,1507:3315,1508:3316,1509:3317,1510:3318,1511:3319,1512:3320,1513:3321,1514:3322,1548:1452,1563:1467,1567:1471,1569:1473,1570:1474,1571:1475,1572:1476,1573:1477,1574:1478,1575:1479,1576:1480,1577:1481,1578:1482,1579:1483,1580:1484,1581:1485,1582:1486,1583:1487,1584:1488,1585:1489,1586:1490,1587:1491,1588:1492,1589:1493,1590:1494,1591:1495,1592:1496,1593:1497,1594:1498,1600:1504,1601:1505,1602:1506,1603:1507,1604:1508,1605:1509,1606:1510,1607:1511,1608:1512,1609:1513,1610:1514,1611:1515,1612:1516,1613:1517,1614:1518,1615:1519,1616:1520,1617:1521,1618:1522,3585:3489,3586:3490,3587:3491,3588:3492,3589:3493,3590:3494,3591:3495,3592:3496,3593:3497,3594:3498,3595:3499,3596:3500,3597:3501,3598:3502,3599:3503,3600:3504,3601:3505,3602:3506,3603:3507,3604:3508,3605:3509,3606:3510,3607:3511,3608:3512,3609:3513,3610:3514,3611:3515,3612:3516,3613:3517,3614:3518,3615:3519,3616:3520,3617:3521,3618:3522,3619:3523,3620:3524,3621:3525,3622:3526,3623:3527,3624:3528,3625:3529,3626:3530,3627:3531,3628:3532,3629:3533,3630:3534,3631:3535,3632:3536,3633:3537,3634:3538,3635:3539,3636:3540,3637:3541,3638:3542,3639:3543,3640:3544,3641:3545,3642:3546,3647:3551,3648:3552,3649:3553,3650:3554,3651:3555,3652:3556,3653:3557,3654:3558,3655:3559,3656:3560,3657:3561,3658:3562,3659:3563,3660:3564,3661:3565,3664:3568,3665:3569,3666:3570,3667:3571,3668:3572,3669:3573,3670:3574,3671:3575,3672:3576,3673:3577,8194:2722,8195:2721,8196:2723,8197:2724,8199:2725,8200:2726,8201:2727,8202:2728,8210:2747,8211:2730,8212:2729,8213:1967,8215:3295,8216:2768,8217:2769,8218:2813,8220:2770,8221:2771,8222:2814,8224:2801,8225:2802,8226:2790,8229:2735,8230:2734,8240:2773,8242:2774,8243:2775,8248:2812,8254:1150,8361:3839,8364:8364,8453:2744,8470:1712,8471:2811,8478:2772,8482:2761,8531:2736,8532:2737,8533:2738,8534:2739,8535:2740,8536:2741,8537:2742,8538:2743,8539:2755,8540:2756,8541:2757,8542:2758,8592:2299,8593:2300,8594:2301,8595:2302,8658:2254,8660:2253,8706:2287,8711:2245,8728:3018,8730:2262,8733:2241,8734:2242,8743:2270,8744:2271,8745:2268,8746:2269,8747:2239,8756:2240,8764:2248,8771:2249,8773:16785992,8800:2237,8801:2255,8804:2236,8805:2238,8834:2266,8835:2267,8866:3068,8867:3036,8868:3010,8869:3022,8968:3027,8970:3012,8981:2810,8992:2212,8993:2213,9109:3020,9115:2219,9117:2220,9118:2221,9120:2222,9121:2215,9123:2216,9124:2217,9126:2218,9128:2223,9132:2224,9143:2209,9146:2543,9147:2544,9148:2546,9149:2547,9225:2530,9226:2533,9227:2537,9228:2531,9229:2532,9251:2732,9252:2536,9472:2211,9474:2214,9484:2210,9488:2539,9492:2541,9496:2538,9500:2548,9508:2549,9516:2551,9524:2550,9532:2542,9618:2529,9642:2791,9643:2785,9644:2779,9645:2786,9646:2783,9647:2767,9650:2792,9651:2787,9654:2781,9655:2765,9660:2793,9661:2788,9664:2780,9665:2764,9670:2528,9675:2766,9679:2782,9702:2784,9734:2789,9742:2809,9747:2762,9756:2794,9758:2795,9792:2808,9794:2807,9827:2796,9829:2798,9830:2797,9837:2806,9839:2805,10003:2803,10007:2804,10013:2777,10016:2800,10216:2748,10217:2750,12289:1188,12290:1185,12300:1186,12301:1187,12443:1246,12444:1247,12449:1191,12450:1201,12451:1192,12452:1202,12453:1193,12454:1203,12455:1194,12456:1204,12457:1195,12458:1205,12459:1206,12461:1207,12463:1208,12465:1209,12467:1210,12469:1211,12471:1212,12473:1213,12475:1214,12477:1215,12479:1216,12481:1217,12483:1199,12484:1218,12486:1219,12488:1220,12490:1221,12491:1222,12492:1223,12493:1224,12494:1225,12495:1226,12498:1227,12501:1228,12504:1229,12507:1230,12510:1231,12511:1232,12512:1233,12513:1234,12514:1235,12515:1196,12516:1236,12517:1197,12518:1237,12519:1198,12520:1238,12521:1239,12522:1240,12523:1241,12524:1242,12525:1243,12527:1244,12530:1190,12531:1245,12539:1189,12540:1200},z={lookup:function(e){if(e>=32&&e<=255)return e;var t=j[e];return void 0!==t?t:16777216|e}},V={8:"Backspace",9:"Tab",10:"NumpadClear",12:"Numpad5",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",19:"Pause",20:"CapsLock",21:"Lang1",25:"Lang2",27:"Escape",28:"Convert",29:"NonConvert",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",44:"PrintScreen",45:"Insert",46:"Delete",47:"Help",48:"Digit0",49:"Digit1",50:"Digit2",51:"Digit3",52:"Digit4",53:"Digit5",54:"Digit6",55:"Digit7",56:"Digit8",57:"Digit9",91:"MetaLeft",92:"MetaRight",93:"ContextMenu",95:"Sleep",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",108:"NumpadDecimal",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",144:"NumLock",145:"ScrollLock",166:"BrowserBack",167:"BrowserForward",168:"BrowserRefresh",169:"BrowserStop",170:"BrowserSearch",171:"BrowserFavorites",172:"BrowserHome",173:"AudioVolumeMute",174:"AudioVolumeDown",175:"AudioVolumeUp",176:"MediaTrackNext",177:"MediaTrackPrevious",178:"MediaStop",179:"MediaPlayPause",180:"LaunchMail",181:"MediaSelect",182:"LaunchApp1",183:"LaunchApp2",225:"AltRight"},W={Backspace:"Backspace",AltLeft:"Alt",AltRight:"Alt",CapsLock:"CapsLock",ContextMenu:"ContextMenu",ControlLeft:"Control",ControlRight:"Control",Enter:"Enter",MetaLeft:"Meta",MetaRight:"Meta",ShiftLeft:"Shift",ShiftRight:"Shift",Tab:"Tab",Delete:"Delete",End:"End",Help:"Help",Home:"Home",Insert:"Insert",PageDown:"PageDown",PageUp:"PageUp",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",NumLock:"NumLock",NumpadBackspace:"Backspace",NumpadClear:"Clear",Escape:"Escape",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",F13:"F13",F14:"F14",F15:"F15",F16:"F16",F17:"F17",F18:"F18",F19:"F19",F20:"F20",F21:"F21",F22:"F22",F23:"F23",F24:"F24",F25:"F25",F26:"F26",F27:"F27",F28:"F28",F29:"F29",F30:"F30",F31:"F31",F32:"F32",F33:"F33",F34:"F34",F35:"F35",PrintScreen:"PrintScreen",ScrollLock:"ScrollLock",Pause:"Pause",BrowserBack:"BrowserBack",BrowserFavorites:"BrowserFavorites",BrowserForward:"BrowserForward",BrowserHome:"BrowserHome",BrowserRefresh:"BrowserRefresh",BrowserSearch:"BrowserSearch",BrowserStop:"BrowserStop",Eject:"Eject",LaunchApp1:"LaunchMyComputer",LaunchApp2:"LaunchCalendar",LaunchMail:"LaunchMail",MediaPlayPause:"MediaPlay",MediaStop:"MediaStop",MediaTrackNext:"MediaTrackNext",MediaTrackPrevious:"MediaTrackPrevious",Power:"Power",Sleep:"Sleep",AudioVolumeDown:"AudioVolumeDown",AudioVolumeMute:"AudioVolumeMute",AudioVolumeUp:"AudioVolumeUp",WakeUp:"WakeUp"},G=65288,X=65289,Y=65291,q=65293,Z=65299,J=65300,$=65307,ee=65535,te=65312,ie=65335,se=65340,ne=65341,re=65342,ae=65313,oe=65314,he=65315,ce=65316,ue=65317,le=65318,de=65319,_e=65320,fe=65321,ve=65322,pe=65326,me=65327,ge=65328,ye=65360,ke=65361,we=65362,be=65363,Ee=65364,Ce=65365,Se=65366,Qe=65367,xe=65376,Ae=65377,Fe=65378,De=65379,Be=65381,Re=65382,Le=65383,Te=65384,Me=65385,Ue=65386,Oe=65406,Ie=65407,Pe=65408,Ne=65421,Ke=65429,He=65430,je=65431,ze=65432,Ve=65433,We=65434,Ge=65435,Xe=65436,Ye=65437,qe=65438,Ze=65439,Je=65469,$e=65450,et=65451,tt=65452,it=65453,st=65454,nt=65455,rt=65456,at=65457,ot=65458,ht=65459,ct=65460,ut=65461,lt=65462,dt=65463,_t=65464,ft=65465,vt=65470,pt=65471,mt=65472,gt=65473,yt=65474,kt=65475,wt=65476,bt=65477,Et=65478,Ct=65479,St=65480,Qt=65481,xt=65482,At=65483,Ft=65484,Dt=65485,Bt=65486,Rt=65487,Lt=65488,Tt=65489,Mt=65490,Ut=65491,Ot=65492,It=65493,Pt=65494,Nt=65495,Kt=65496,Ht=65497,jt=65498,zt=65499,Vt=65500,Wt=65501,Gt=65502,Xt=65503,Yt=65504,qt=65505,Zt=65506,Jt=65507,$t=65508,ei=65509,ti=65513,ii=65514,si=65515,ni=65516,ri=65027,ai=65032,oi=65034,hi=65036,ci=65038,ui=32,li=42,di=43,_i=44,fi=45,vi=46,pi=47,mi=48,gi=49,yi=50,ki=51,wi=52,bi=53,Ei=54,Ci=55,Si=56,Qi=57,xi=61,Ai=65329,Fi=65332,Di=65336,Bi=269025026,Ri=269025027,Li=269025040,Ti=269025041,Mi=269025042,Ui=269025043,Oi=269025044,Ii=269025045,Pi=269025046,Ni=269025047,Ki=269025048,Hi=269025049,ji=269025051,zi=269025052,Vi=269025053,Wi=269025056,Gi=269025057,Xi=269025062,Yi=269025063,qi=269025064,Zi=269025065,Ji=269025066,$i=269025067,es=269025068,ts=269025069,is=269025070,ss=269025072,ns=269025073,rs=269025074,as=269025075,os=269025083,hs=269025086,cs=269025110,us=269025111,ls=269025112,ds=269025116,_s=269025121,fs=269025128,vs=269025131,ps=269025133,ms=269025134,gs=269025138,ys=269025143,ks=269025147,ws=269025148,bs=269025149,Es=269025161,Cs=269025163,Ss=269025164,Qs=269025167,xs=269025168,As=269025170,Fs=269025175,Ds=269025177,Bs=269025178,Rs=269025179,Ls=269025192,Ts=269025202,Ms=269024802,Us={};function Os(e,t){if(void 0===t)throw new Error('Undefined keysym for key "'+e+'"');if(e in Us)throw new Error('Duplicate entry for key "'+e+'"');Us[e]=[t,t,t,t]}function Is(e,t,i){if(void 0===t)throw new Error('Undefined keysym for key "'+e+'"');if(void 0===i)throw new Error('Undefined keysym for key "'+e+'"');if(e in Us)throw new Error('Duplicate entry for key "'+e+'"');Us[e]=[t,t,i,t]}function Ps(e,t,i){if(void 0===t)throw new Error('Undefined keysym for key "'+e+'"');if(void 0===i)throw new Error('Undefined keysym for key "'+e+'"');if(e in Us)throw new Error('Duplicate entry for key "'+e+'"');Us[e]=[t,t,t,i]}Is("Alt",ti,ii),Os("AltGraph",ri),Os("CapsLock",ei),Is("Control",Jt,$t),Is("Hyper",si,ni),Is("Meta",si,ni),Os("NumLock",Ie),Os("ScrollLock",J),Is("Shift",qt,Zt),Is("Super",si,ni),Ps("Enter",q,Ne),Os("Tab",X),Ps(" ",ui,Pe),Ps("ArrowDown",Ee,Ve),Ps("ArrowUp",we,je),Ps("ArrowLeft",ke,He),Ps("ArrowRight",be,ze),Ps("End",Qe,Xe),Ps("Home",ye,Ke),Ps("PageDown",Se,Ge),Ps("PageUp",Ce,We),Os("Backspace",G),Ps("Clear",Y,Ye),Os("Copy",us),Os("Cut",ls),Ps("Delete",ee,Ze),Ps("Insert",De,qe),Os("Paste",ps),Os("Redo",Re),Os("Undo",Be),Os("Cancel",Me),Os("ContextMenu",Le),Os("Escape",$),Os("Execute",Fe),Os("Find",Te),Os("Help",Ue),Os("Pause",Z),Os("Select",xe),Os("ZoomIn",Cs),Os("ZoomOut",Ss),Os("BrightnessDown",Ri),Os("BrightnessUp",Bi),Os("Eject",es),Os("LogOff",_s),Os("Power",Ji),Os("PowerOff",Gi),Os("PrintScreen",Ae),Os("Hibernate",Ls),Os("Standby",Li),Os("WakeUp",$i),Os("AllCandidates",ne),Os("Alphanumeric",me),Os("CodeInput",ie),Os("Compose",te),Os("Convert",he),Os("GroupFirst",hi),Os("GroupLast",ci),Os("GroupNext",ai),Os("GroupPrevious",oi),Os("NonConvert",oe),Os("PreviousCandidate",re),Os("SingleCandidate",se),Os("HangulMode",Ai),Os("HanjaMode",Fi),Os("JunjuaMode",Di),Os("Eisu",ge),Os("Hankaku",fe),Os("Hiragana",ue),Os("HiraganaKatakana",de),Os("KanaMode",pe),Os("KanjiMode",ae),Os("Katakana",le),Os("Romaji",ce),Os("Zenkaku",_e),Os("ZenkakuHanaku",ve),Os("F1",vt),Os("F2",pt),Os("F3",mt),Os("F4",gt),Os("F5",yt),Os("F6",kt),Os("F7",wt),Os("F8",bt),Os("F9",Et),Os("F10",Ct),Os("F11",St),Os("F12",Qt),Os("F13",xt),Os("F14",At),Os("F15",Ft),Os("F16",Dt),Os("F17",Bt),Os("F18",Rt),Os("F19",Lt),Os("F20",Tt),Os("F21",Mt),Os("F22",Ut),Os("F23",Ot),Os("F24",It),Os("F25",Pt),Os("F26",Nt),Os("F27",Kt),Os("F28",Ht),Os("F29",jt),Os("F30",zt),Os("F31",Vt),Os("F32",Wt),Os("F33",Gt),Os("F34",Xt),Os("F35",Yt),Os("Close",cs),Os("MailForward",xs),Os("MailReply",gs),Os("MainSend",ks),Os("MediaFastForward",Fs),Os("MediaPause",ns),Os("MediaPlay",Oi),Os("MediaRecord",zi),Os("MediaRewind",hs),Os("MediaStop",Ii),Os("MediaTrackNext",Ni),Os("MediaTrackPrevious",Pi),Os("New",fs),Os("Open",vs),Os("Print",Ae),Os("Save",ys),Os("SpellCheck",ws),Os("AudioVolumeDown",Ti),Os("AudioVolumeUp",Ui),Os("AudioVolumeMute",Mi),Os("MicrophoneVolumeMute",Ts),Os("LaunchCalculator",Vi),Os("LaunchCalendar",Wi),Os("LaunchMail",Hi),Os("LaunchMediaPlayer",rs),Os("LaunchMusicPlayer",As),Os("LaunchMyComputer",as),Os("LaunchPhone",ms),Os("LaunchScreenSaver",ts),Os("LaunchSpreadsheet",ds),Os("LaunchWebBrowser",is),Os("LaunchWebCam",Qs),Os("LaunchWordProcessor",Es),Os("BrowserBack",Xi),Os("BrowserFavorites",ss),Os("BrowserForward",Yi),Os("BrowserHome",Ki),Os("BrowserRefresh",Zi),Os("BrowserSearch",ji),Os("BrowserStop",qi),Os("Dimmer",os),Os("MediaAudioTrack",Rs),Os("RandomToggle",Ds),Os("SplitScreenToggle",bs),Os("Subtitle",Bs),Os("VideoModeNext",Ms),Ps("=",xi,Je),Ps("+",di,et),Ps("-",fi,it),Ps("*",li,$e),Ps("/",pi,nt),Ps(".",vi,st),Ps(",",_i,tt),Ps("0",mi,rt),Ps("1",gi,at),Ps("2",yi,ot),Ps("3",ki,ht),Ps("4",wi,ct),Ps("5",bi,ut),Ps("6",Ei,lt),Ps("7",Ci,dt),Ps("8",Si,_t),Ps("9",Qi,ft);var Ns=Us;function Ks(e){if(e.code){switch(e.code){case"OSLeft":return"MetaLeft";case"OSRight":return"MetaRight"}return e.code}if("keypress"!==e.type&&e.keyCode in V){var t=V[e.keyCode];if(A()&&"ContextMenu"===t&&(t="MetaRight"),2===e.location)switch(t){case"ShiftLeft":return"ShiftRight";case"ControlLeft":return"ControlRight";case"AltLeft":return"AltRight"}if(3===e.location)switch(t){case"Delete":return"NumpadDecimal";case"Insert":return"Numpad0";case"End":return"Numpad1";case"ArrowDown":return"Numpad2";case"PageDown":return"Numpad3";case"ArrowLeft":return"Numpad4";case"ArrowRight":return"Numpad6";case"Home":return"Numpad7";case"ArrowUp":return"Numpad8";case"PageUp":return"Numpad9";case"Enter":return"NumpadEnter"}return t}return"Unidentified"}function Hs(e){var t=function(e){if(void 0!==e.key){switch(e.key){case"Spacebar":return" ";case"Esc":return"Escape";case"Scroll":return"ScrollLock";case"Win":return"Meta";case"Apps":return"ContextMenu";case"Up":return"ArrowUp";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Down":return"ArrowDown";case"Del":return"Delete";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Add":return"+";case"Decimal":return e.char}switch(e.key){case"OS":return"Meta"}switch(e.key){case"UIKeyInputUpArrow":return"ArrowUp";case"UIKeyInputDownArrow":return"ArrowDown";case"UIKeyInputLeftArrow":return"ArrowLeft";case"UIKeyInputRightArrow":return"ArrowRight";case"UIKeyInputEscape":return"Escape"}if(1!==e.key.length||!D()&&!B())return e.key}var t=Ks(e);return t in W?W[t]:e.charCode?String.fromCharCode(e.charCode):"Unidentified"}(e);if("Unidentified"===t)return null;if(t in Ns){var i=e.location;return"Meta"===t&&0===i&&(i=2),(void 0===i||i>3)&&(i=0),Ns[t][i]}if(1!==t.length)return null;var s=t.charCodeAt();return s?z.lookup(s):null}var js,zs,Vs,Ws,Gs,Xs,Ys=function(){function e(t){Object(o.a)(this,e),this._target=t||null,this._keyDownList={},this._pendingKey=null,this._altGrArmed=!1,this._eventHandlers={keyup:this._handleKeyUp.bind(this),keydown:this._handleKeyDown.bind(this),keypress:this._handleKeyPress.bind(this),blur:this._allKeysUp.bind(this),checkalt:this._checkAlt.bind(this)},this.onkeyevent=function(){}}return Object(h.a)(e,[{key:"_sendKeyEvent",value:function(e,t,i){if(i)this._keyDownList[t]=e;else{if(!(t in this._keyDownList))return;delete this._keyDownList[t]}p("onkeyevent "+(i?"down":"up")+", keysym: "+e,", code: "+t),this.onkeyevent(e,t,i)}},{key:"_getKeyCode",value:function(e){var t=Ks(e);if("Unidentified"!==t)return t;if(e.keyCode&&"keypress"!==e.type&&229!==e.keyCode)return"Platform"+e.keyCode;if(e.keyIdentifier){if("U+"!==e.keyIdentifier.substr(0,2))return e.keyIdentifier;var i=parseInt(e.keyIdentifier.substr(2),16);return"Platform"+String.fromCharCode(i).toUpperCase().charCodeAt()}return"Unidentified"}},{key:"_handleKeyDown",value:function(e){var t=this._getKeyCode(e),i=Hs(e);if(this._altGrArmed&&(this._altGrArmed=!1,clearTimeout(this._altGrTimeout),"AltRight"===t&&e.timeStamp-this._altGrCtrlTime<50?i=ri:this._sendKeyEvent(Jt,"ControlLeft",!0)),"Unidentified"===t||navigator&&(/ipad/i.exec(navigator.platform)||/iphone/i.exec(navigator.platform)||/ipod/i.exec(navigator.platform)))return i&&(this._sendKeyEvent(i,t,!0),this._sendKeyEvent(i,t,!1)),void U(e);if(A())switch(i){case si:i=ti;break;case ni:i=si;break;case ti:i=Oe;break;case ii:i=ri}return t in this._keyDownList&&(i=this._keyDownList[t]),A()&&"CapsLock"===t?(this._sendKeyEvent(ei,"CapsLock",!0),this._sendKeyEvent(ei,"CapsLock",!1),void U(e)):i||e.key&&!D()&&!B()?(this._pendingKey=null,U(e),"ControlLeft"!==t||!F()||"ControlLeft"in this._keyDownList?void this._sendKeyEvent(i,t,!0):(this._altGrArmed=!0,this._altGrTimeout=setTimeout(this._handleAltGrTimeout.bind(this),100),void(this._altGrCtrlTime=e.timeStamp))):(this._pendingKey=t,void setTimeout(this._handleKeyPressTimeout.bind(this),10,e))}},{key:"_handleKeyPress",value:function(e){if(U(e),null!==this._pendingKey){var t=this._getKeyCode(e),i=Hs(e);"Unidentified"!==t&&t!=this._pendingKey||(t=this._pendingKey,this._pendingKey=null,i?this._sendKeyEvent(i,t,!0):m("keypress with no keysym:",e))}}},{key:"_handleKeyPressTimeout",value:function(e){if(null!==this._pendingKey){var t,i=this._pendingKey;if(this._pendingKey=null,e.keyCode>=48&&e.keyCode<=57)t=e.keyCode;else if(e.keyCode>=65&&e.keyCode<=90){var s=String.fromCharCode(e.keyCode);t=(s=e.shiftKey?s.toUpperCase():s.toLowerCase()).charCodeAt()}else t=0;this._sendKeyEvent(t,i,!0)}}},{key:"_handleKeyUp",value:function(e){U(e);var t=this._getKeyCode(e);if(this._altGrArmed&&(this._altGrArmed=!1,clearTimeout(this._altGrTimeout),this._sendKeyEvent(Jt,"ControlLeft",!0)),A()&&"CapsLock"===t)return this._sendKeyEvent(ei,"CapsLock",!0),void this._sendKeyEvent(ei,"CapsLock",!1);this._sendKeyEvent(this._keyDownList[t],t,!1)}},{key:"_handleAltGrTimeout",value:function(){this._altGrArmed=!1,clearTimeout(this._altGrTimeout),this._sendKeyEvent(Jt,"ControlLeft",!0)}},{key:"_allKeysUp",value:function(){for(var e in p(">> Keyboard.allKeysUp"),this._keyDownList)this._sendKeyEvent(this._keyDownList[e],e,!1);p("<< Keyboard.allKeysUp")}},{key:"_checkAlt",value:function(e){if(!e.skipCheckAlt&&!e.altKey){var t=this._target,i=this._keyDownList;["AltLeft","AltRight"].forEach((function(e){if(e in i){var s=new KeyboardEvent("keyup",{key:i[e],code:e});s.skipCheckAlt=!0,t.dispatchEvent(s)}}))}}},{key:"grab",value:function(){if(this._target.addEventListener("keydown",this._eventHandlers.keydown),this._target.addEventListener("keyup",this._eventHandlers.keyup),this._target.addEventListener("keypress",this._eventHandlers.keypress),window.addEventListener("blur",this._eventHandlers.blur),F()&&R()){var e=this._eventHandlers.checkalt;["mousedown","mouseup","mousemove","wheel","touchstart","touchend","touchmove","keydown","keyup"].forEach((function(t){return document.addEventListener(t,e,{capture:!0,passive:!0})}))}}},{key:"ungrab",value:function(){if(F()&&R()){var e=this._eventHandlers.checkalt;["mousedown","mouseup","mousemove","wheel","touchstart","touchend","touchmove","keydown","keyup"].forEach((function(t){return document.removeEventListener(t,e)}))}this._target.removeEventListener("keydown",this._eventHandlers.keydown),this._target.removeEventListener("keyup",this._eventHandlers.keyup),this._target.removeEventListener("keypress",this._eventHandlers.keypress),window.removeEventListener("blur",this._eventHandlers.blur),this._allKeysUp()}}]),e}(),qs=function(){function e(t){Object(o.a)(this,e),this._target=t||document,this._doubleClickTimer=null,this._lastTouchPos=null,this._pos=null,this._wheelStepXTimer=null,this._wheelStepYTimer=null,this._accumulatedWheelDeltaX=0,this._accumulatedWheelDeltaY=0,this._eventHandlers={mousedown:this._handleMouseDown.bind(this),mouseup:this._handleMouseUp.bind(this),mousemove:this._handleMouseMove.bind(this),mousewheel:this._handleMouseWheel.bind(this),mousedisable:this._handleMouseDisable.bind(this)},this.touchButton=1,this.onmousebutton=function(){},this.onmousemove=function(){}}return Object(h.a)(e,[{key:"_resetDoubleClickTimer",value:function(){this._doubleClickTimer=null}},{key:"_handleMouseButton",value:function(e,t){this._updateMousePosition(e);var i,s=this._pos;if(e.touches||e.changedTouches){if(1==t){if(null===this._doubleClickTimer)this._lastTouchPos=s;else{clearTimeout(this._doubleClickTimer);var n=this._lastTouchPos.x-s.x,r=this._lastTouchPos.y-s.y;Math.sqrt(n*n+r*r)<20*(window.devicePixelRatio||1)&&(s=this._lastTouchPos)}this._doubleClickTimer=setTimeout(this._resetDoubleClickTimer.bind(this),500)}i=this.touchButton}else i=e.which?1<<e.button:(1&e.button)+2*(2&e.button)+(4&e.button)/2;p("onmousebutton "+(t?"down":"up")+", x: "+s.x+", y: "+s.y+", bmask: "+i),this.onmousebutton(s.x,s.y,t,i),U(e)}},{key:"_handleMouseDown",value:function(e){"mousedown"===e.type&&function(e){if(e.setCapture)e.setCapture(),document.captureElement=e,e.addEventListener("mouseup",H);else{H();var t=document.getElementById("noVNC_mouse_capture_elem");null===t&&((t=document.createElement("div")).id="noVNC_mouse_capture_elem",t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.width="100%",t.style.height="100%",t.style.zIndex=1e4,t.style.display="none",document.body.appendChild(t),t.addEventListener("contextmenu",P),t.addEventListener("mousemove",P),t.addEventListener("mouseup",P)),document.captureElement=e,K.observe(e,{attributes:!0}),N(),t.style.display="",window.addEventListener("mousemove",P),window.addEventListener("mouseup",P)}}(this._target),this._handleMouseButton(e,1)}},{key:"_handleMouseUp",value:function(e){this._handleMouseButton(e,0)}},{key:"_generateWheelStepX",value:function(){this._accumulatedWheelDeltaX<0?(this.onmousebutton(this._pos.x,this._pos.y,1,32),this.onmousebutton(this._pos.x,this._pos.y,0,32)):this._accumulatedWheelDeltaX>0&&(this.onmousebutton(this._pos.x,this._pos.y,1,64),this.onmousebutton(this._pos.x,this._pos.y,0,64)),this._accumulatedWheelDeltaX=0}},{key:"_generateWheelStepY",value:function(){this._accumulatedWheelDeltaY<0?(this.onmousebutton(this._pos.x,this._pos.y,1,8),this.onmousebutton(this._pos.x,this._pos.y,0,8)):this._accumulatedWheelDeltaY>0&&(this.onmousebutton(this._pos.x,this._pos.y,1,16),this.onmousebutton(this._pos.x,this._pos.y,0,16)),this._accumulatedWheelDeltaY=0}},{key:"_resetWheelStepTimers",value:function(){window.clearTimeout(this._wheelStepXTimer),window.clearTimeout(this._wheelStepYTimer),this._wheelStepXTimer=null,this._wheelStepYTimer=null}},{key:"_handleMouseWheel",value:function(e){this._resetWheelStepTimers(),this._updateMousePosition(e);var t=e.deltaX,i=e.deltaY;0!==e.deltaMode&&(t*=19,i*=19),this._accumulatedWheelDeltaX+=t,this._accumulatedWheelDeltaY+=i,Math.abs(this._accumulatedWheelDeltaX)>10?this._generateWheelStepX():this._wheelStepXTimer=window.setTimeout(this._generateWheelStepX.bind(this),50),Math.abs(this._accumulatedWheelDeltaY)>10?this._generateWheelStepY():this._wheelStepYTimer=window.setTimeout(this._generateWheelStepY.bind(this),50),U(e)}},{key:"_handleMouseMove",value:function(e){this._updateMousePosition(e),this.onmousemove(this._pos.x,this._pos.y),U(e)}},{key:"_handleMouseDisable",value:function(e){e.target==this._target&&U(e)}},{key:"_updateMousePosition",value:function(e){e=function(e){return e.changedTouches?e.changedTouches[0]:e.touches?e.touches[0]:e}(e);var t,i,s=this._target.getBoundingClientRect();t=e.clientX<s.left?0:e.clientX>=s.right?s.width-1:e.clientX-s.left,i=e.clientY<s.top?0:e.clientY>=s.bottom?s.height-1:e.clientY-s.top,this._pos={x:t,y:i}}},{key:"grab",value:function(){w&&(this._target.addEventListener("touchstart",this._eventHandlers.mousedown),this._target.addEventListener("touchend",this._eventHandlers.mouseup),this._target.addEventListener("touchmove",this._eventHandlers.mousemove)),this._target.addEventListener("mousedown",this._eventHandlers.mousedown),this._target.addEventListener("mouseup",this._eventHandlers.mouseup),this._target.addEventListener("mousemove",this._eventHandlers.mousemove),this._target.addEventListener("wheel",this._eventHandlers.mousewheel),document.addEventListener("click",this._eventHandlers.mousedisable),this._target.addEventListener("contextmenu",this._eventHandlers.mousedisable)}},{key:"ungrab",value:function(){this._resetWheelStepTimers(),w&&(this._target.removeEventListener("touchstart",this._eventHandlers.mousedown),this._target.removeEventListener("touchend",this._eventHandlers.mouseup),this._target.removeEventListener("touchmove",this._eventHandlers.mousemove)),this._target.removeEventListener("mousedown",this._eventHandlers.mousedown),this._target.removeEventListener("mouseup",this._eventHandlers.mouseup),this._target.removeEventListener("mousemove",this._eventHandlers.mousemove),this._target.removeEventListener("wheel",this._eventHandlers.mousewheel),document.removeEventListener("click",this._eventHandlers.mousedisable),this._target.removeEventListener("contextmenu",this._eventHandlers.mousedisable)}}]),e}(),Zs=!S||w,Js=function(){function e(){Object(o.a)(this,e),this._target=null,this._canvas=document.createElement("canvas"),Zs&&(this._canvas.style.position="fixed",this._canvas.style.zIndex="65535",this._canvas.style.pointerEvents="none",this._canvas.style.visibility="hidden",document.body.appendChild(this._canvas)),this._position={x:0,y:0},this._hotSpot={x:0,y:0},this._eventHandlers={mouseover:this._handleMouseOver.bind(this),mouseleave:this._handleMouseLeave.bind(this),mousemove:this._handleMouseMove.bind(this),mouseup:this._handleMouseUp.bind(this),touchstart:this._handleTouchStart.bind(this),touchmove:this._handleTouchMove.bind(this),touchend:this._handleTouchEnd.bind(this)}}return Object(h.a)(e,[{key:"attach",value:function(e){if(this._target&&this.detach(),this._target=e,Zs){var t={capture:!0,passive:!0};this._target.addEventListener("mouseover",this._eventHandlers.mouseover,t),this._target.addEventListener("mouseleave",this._eventHandlers.mouseleave,t),this._target.addEventListener("mousemove",this._eventHandlers.mousemove,t),this._target.addEventListener("mouseup",this._eventHandlers.mouseup,t),window.addEventListener("touchstart",this._eventHandlers.touchstart,t),this._target.addEventListener("touchmove",this._eventHandlers.touchmove,t),this._target.addEventListener("touchend",this._eventHandlers.touchend,t)}this.clear()}},{key:"detach",value:function(){if(Zs){var e={capture:!0,passive:!0};this._target.removeEventListener("mouseover",this._eventHandlers.mouseover,e),this._target.removeEventListener("mouseleave",this._eventHandlers.mouseleave,e),this._target.removeEventListener("mousemove",this._eventHandlers.mousemove,e),this._target.removeEventListener("mouseup",this._eventHandlers.mouseup,e),window.removeEventListener("touchstart",this._eventHandlers.touchstart,e),this._target.removeEventListener("touchmove",this._eventHandlers.touchmove,e),this._target.removeEventListener("touchend",this._eventHandlers.touchend,e)}this._target=null}},{key:"change",value:function(e,t,i,s,n){if(0!==s&&0!==n){this._position.x=this._position.x+this._hotSpot.x-t,this._position.y=this._position.y+this._hotSpot.y-i,this._hotSpot.x=t,this._hotSpot.y=i;var r,a=this._canvas.getContext("2d");this._canvas.width=s,this._canvas.height=n;try{r=new ImageData(new Uint8ClampedArray(e),s,n)}catch(ha){(r=a.createImageData(s,n)).data.set(new Uint8ClampedArray(e))}if(a.clearRect(0,0,s,n),a.putImageData(r,0,0),Zs)this._updatePosition();else{var o=this._canvas.toDataURL();this._target.style.cursor="url("+o+")"+t+" "+i+", default"}}else this.clear()}},{key:"clear",value:function(){this._target.style.cursor="none",this._canvas.width=0,this._canvas.height=0,this._position.x=this._position.x+this._hotSpot.x,this._position.y=this._position.y+this._hotSpot.y,this._hotSpot.x=0,this._hotSpot.y=0}},{key:"_handleMouseOver",value:function(e){this._handleMouseMove(e)}},{key:"_handleMouseLeave",value:function(e){this._updateVisibility(e.relatedTarget)}},{key:"_handleMouseMove",value:function(e){this._updateVisibility(e.target),this._position.x=e.clientX-this._hotSpot.x,this._position.y=e.clientY-this._hotSpot.y,this._updatePosition()}},{key:"_handleMouseUp",value:function(e){var t=this,i=document.elementFromPoint(e.clientX,e.clientY);this._updateVisibility(i),this._captureIsActive()&&window.setTimeout((function(){i=document.elementFromPoint(e.clientX,e.clientY),t._updateVisibility(i)}),0)}},{key:"_handleTouchStart",value:function(e){this._handleTouchMove(e)}},{key:"_handleTouchMove",value:function(e){this._updateVisibility(e.target),this._position.x=e.changedTouches[0].clientX-this._hotSpot.x,this._position.y=e.changedTouches[0].clientY-this._hotSpot.y,this._updatePosition()}},{key:"_handleTouchEnd",value:function(e){var t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);this._updateVisibility(t)}},{key:"_showCursor",value:function(){"hidden"===this._canvas.style.visibility&&(this._canvas.style.visibility="")}},{key:"_hideCursor",value:function(){"hidden"!==this._canvas.style.visibility&&(this._canvas.style.visibility="hidden")}},{key:"_shouldShowCursor",value:function(e){return!!e&&(e===this._target||!!this._target.contains(e)&&"none"===window.getComputedStyle(e).cursor)}},{key:"_updateVisibility",value:function(e){this._captureIsActive()&&(e=document.captureElement),this._shouldShowCursor(e)?this._showCursor():this._hideCursor()}},{key:"_updatePosition",value:function(){this._canvas.style.left=this._position.x+"px",this._canvas.style.top=this._position.y+"px"}},{key:"_captureIsActive",value:function(){return document.captureElement&&document.documentElement.contains(document.captureElement)}}]),e}(),$s=function(){function e(){Object(o.a)(this,e),this._websocket=null,this._rQi=0,this._rQlen=0,this._rQbufferSize=4194304,this._rQ=null,this._sQbufferSize=10240,this._sQlen=0,this._sQ=null,this._eventHandlers={message:function(){},open:function(){},close:function(){},error:function(){}}}return Object(h.a)(e,[{key:"rQpeek8",value:function(){return this._rQ[this._rQi]}},{key:"rQskipBytes",value:function(e){this._rQi+=e}},{key:"rQshift8",value:function(){return this._rQshift(1)}},{key:"rQshift16",value:function(){return this._rQshift(2)}},{key:"rQshift32",value:function(){return this._rQshift(4)}},{key:"_rQshift",value:function(e){for(var t=0,i=e-1;i>=0;i--)t+=this._rQ[this._rQi++]<<8*i;return t}},{key:"rQshiftStr",value:function(e){"undefined"===typeof e&&(e=this.rQlen);for(var t="",i=0;i<e;i+=4096){var s=this.rQshiftBytes(Math.min(4096,e-i));t+=String.fromCharCode.apply(null,s)}return t}},{key:"rQshiftBytes",value:function(e){return"undefined"===typeof e&&(e=this.rQlen),this._rQi+=e,new Uint8Array(this._rQ.buffer,this._rQi-e,e)}},{key:"rQshiftTo",value:function(e,t){void 0===t&&(t=this.rQlen),e.set(new Uint8Array(this._rQ.buffer,this._rQi,t)),this._rQi+=t}},{key:"rQslice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rQlen;return new Uint8Array(this._rQ.buffer,this._rQi+e,t-e)}},{key:"rQwait",value:function(e,t,i){if(this.rQlen<t){if(i){if(this._rQi<i)throw new Error("rQwait cannot backup "+i+" bytes");this._rQi-=i}return!0}return!1}},{key:"flush",value:function(){this._sQlen>0&&this._websocket.readyState===WebSocket.OPEN&&(this._websocket.send(this._encode_message()),this._sQlen=0)}},{key:"send",value:function(e){this._sQ.set(e,this._sQlen),this._sQlen+=e.length,this.flush()}},{key:"send_string",value:function(e){this.send(e.split("").map((function(e){return e.charCodeAt(0)})))}},{key:"off",value:function(e){this._eventHandlers[e]=function(){}}},{key:"on",value:function(e,t){this._eventHandlers[e]=t}},{key:"_allocate_buffers",value:function(){this._rQ=new Uint8Array(this._rQbufferSize),this._sQ=new Uint8Array(this._sQbufferSize)}},{key:"init",value:function(){this._allocate_buffers(),this._rQi=0,this._websocket=null}},{key:"open",value:function(e,t){var i=this;this.init(),this._websocket=new WebSocket(e,t),this._websocket.binaryType="arraybuffer",this._websocket.onmessage=this._recv_message.bind(this),this._websocket.onopen=function(){p(">> WebSock.onopen"),i._websocket.protocol&&m("Server choose sub-protocol: "+i._websocket.protocol),i._eventHandlers.open(),p("<< WebSock.onopen")},this._websocket.onclose=function(e){p(">> WebSock.onclose"),i._eventHandlers.close(e),p("<< WebSock.onclose")},this._websocket.onerror=function(e){p(">> WebSock.onerror: "+e),i._eventHandlers.error(e),p("<< WebSock.onerror: "+e)}}},{key:"close",value:function(){this._websocket&&(this._websocket.readyState!==WebSocket.OPEN&&this._websocket.readyState!==WebSocket.CONNECTING||(m("Closing WebSocket connection"),this._websocket.close()),this._websocket.onmessage=function(){})}},{key:"_encode_message",value:function(){return new Uint8Array(this._sQ.buffer,0,this._sQlen)}},{key:"_expand_compact_rQ",value:function(e){var t=8*(this._rQlen-this._rQi+e),i=this._rQbufferSize<t;if(i&&(this._rQbufferSize=Math.max(2*this._rQbufferSize,t)),this._rQbufferSize>41943040&&(this._rQbufferSize=41943040,this._rQbufferSize-this.rQlen<e))throw new Error("Receive Queue buffer exceeded 41943040 bytes, and the new message could not fit");if(i){var s=this._rQ.buffer;this._rQ=new Uint8Array(this._rQbufferSize),this._rQ.set(new Uint8Array(s,this._rQi,this._rQlen-this._rQi))}else this._rQ.set(new Uint8Array(this._rQ.buffer,this._rQi,this._rQlen-this._rQi));this._rQlen=this._rQlen-this._rQi,this._rQi=0}},{key:"_decode_message",value:function(e){var t=new Uint8Array(e);t.length>this._rQbufferSize-this._rQlen&&this._expand_compact_rQ(t.length),this._rQ.set(t,this._rQlen),this._rQlen+=t.length}},{key:"_recv_message",value:function(e){this._decode_message(e.data),this.rQlen>0?(this._eventHandlers.message(),this._rQlen==this._rQi&&(this._rQlen=0,this._rQi=0)):p("Ignoring empty message")}},{key:"sQ",get:function(){return this._sQ}},{key:"rQ",get:function(){return this._rQ}},{key:"rQi",get:function(){return this._rQi},set:function(e){this._rQi=e}},{key:"rQlen",get:function(){return this._rQlen-this._rQi}}]),e}(),en=[13,16,10,23,0,4,2,27,14,5,20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31],tn=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],sn=[(Vs=(js=65536)|(zs=1<<24))|(Gs=1024),0,0|js,Vs|(Xs=(Ws=4)|Gs),Vs|Ws,js|Xs,0|Ws,0|js,0|Gs,Vs|Gs,Vs|Xs,0|Gs,zs|Xs,Vs|Ws,0|zs,0|Ws,0|Xs,zs|Gs,zs|Gs,js|Gs,js|Gs,0|Vs,0|Vs,zs|Xs,js|Ws,zs|Ws,zs|Ws,js|Ws,0,0|Xs,js|Xs,0|zs,0|js,Vs|Xs,0|Ws,0|Vs,Vs|Gs,0|zs,0|zs,0|Gs,Vs|Ws,0|js,js|Gs,zs|Ws,0|Gs,0|Ws,zs|Xs,js|Xs,Vs|Xs,js|Ws,0|Vs,zs|Xs,zs|Ws,0|Xs,js|Xs,Vs|Gs,0|Xs,zs|Gs,zs|Gs,0,js|Ws,js|Gs,0,Vs|Ws],nn=[(Vs=(js=1<<20)|(zs=1<<31))|(Xs=(Ws=32)|(Gs=32768)),zs|Gs,0|Gs,js|Xs,0|js,0|Ws,Vs|Ws,zs|Xs,zs|Ws,Vs|Xs,Vs|Gs,0|zs,zs|Gs,0|js,0|Ws,Vs|Ws,js|Gs,js|Ws,zs|Xs,0,0|zs,0|Gs,js|Xs,0|Vs,js|Ws,zs|Ws,0,js|Gs,0|Xs,Vs|Gs,0|Vs,0|Xs,0,js|Xs,Vs|Ws,0|js,zs|Xs,0|Vs,Vs|Gs,0|Gs,0|Vs,zs|Gs,0|Ws,Vs|Xs,js|Xs,0|Ws,0|Gs,0|zs,0|Xs,Vs|Gs,0|js,zs|Ws,js|Ws,zs|Xs,zs|Ws,js|Ws,js|Gs,0,zs|Gs,0|Xs,0|zs,Vs|Ws,Vs|Xs,js|Gs],rn=[0|(Xs=(Ws=8)|(Gs=512)),(Vs=(js=1<<17)|(zs=1<<27))|Gs,0,Vs|Ws,zs|Gs,0,js|Xs,zs|Gs,js|Ws,zs|Ws,zs|Ws,0|js,Vs|Xs,js|Ws,0|Vs,0|Xs,0|zs,0|Ws,Vs|Gs,0|Gs,js|Gs,0|Vs,Vs|Ws,js|Xs,zs|Xs,js|Gs,0|js,zs|Xs,0|Ws,Vs|Xs,0|Gs,0|zs,Vs|Gs,0|zs,js|Ws,0|Xs,0|js,Vs|Gs,zs|Gs,0,0|Gs,js|Ws,Vs|Xs,zs|Gs,zs|Ws,0|Gs,0,Vs|Ws,zs|Xs,0|js,0|zs,Vs|Xs,0|Ws,js|Xs,js|Gs,zs|Ws,0|Vs,zs|Xs,0|Xs,0|Vs,js|Xs,0|Ws,Vs|Ws,js|Gs],an=[(Vs=(js=8192)|(zs=1<<23))|(Ws=1),js|(Xs=Ws|(Gs=128)),js|Xs,0|Gs,Vs|Gs,zs|Xs,zs|Ws,js|Ws,0,0|Vs,0|Vs,Vs|Xs,0|Xs,0,zs|Gs,zs|Ws,0|Ws,0|js,0|zs,Vs|Ws,0|Gs,0|zs,js|Ws,js|Gs,zs|Xs,0|Ws,js|Gs,zs|Gs,0|js,Vs|Gs,Vs|Xs,0|Xs,zs|Gs,zs|Ws,0|Vs,Vs|Xs,0|Xs,0,0,0|Vs,js|Gs,zs|Gs,zs|Xs,0|Ws,Vs|Ws,js|Xs,js|Xs,0|Gs,Vs|Xs,0|Xs,0|Ws,0|js,zs|Ws,js|Ws,Vs|Gs,zs|Xs,js|Ws,js|Gs,0|zs,Vs|Ws,0|Gs,0|zs,0|js,Vs|Gs],on=[0|(Ws=256),(js=1<<25)|(Xs=Ws|(Gs=1<<19)),js|Gs,(Vs=js|(zs=1<<30))|Ws,0|Gs,0|Ws,0|zs,js|Gs,zs|Xs,0|Gs,js|Ws,zs|Xs,Vs|Ws,Vs|Gs,0|Xs,0|zs,0|js,zs|Gs,zs|Gs,0,zs|Ws,Vs|Xs,Vs|Xs,js|Ws,Vs|Gs,zs|Ws,0,0|Vs,js|Xs,0|js,0|Vs,0|Xs,0|Gs,Vs|Ws,0|Ws,0|js,0|zs,js|Gs,Vs|Ws,zs|Xs,js|Ws,0|zs,Vs|Gs,js|Xs,zs|Xs,0|Ws,0|js,Vs|Gs,Vs|Xs,0|Xs,0|Vs,Vs|Xs,js|Gs,0,zs|Gs,0|Vs,0|Xs,js|Ws,zs|Ws,0|Gs,0,zs|Gs,js|Xs,zs|Ws],hn=[(zs=1<<29)|(Ws=16),0|(Vs=(js=1<<22)|zs),0|(Gs=16384),Vs|(Xs=Ws|Gs),0|Vs,0|Ws,Vs|Xs,0|js,zs|Gs,js|Xs,0|js,zs|Ws,js|Ws,zs|Gs,0|zs,0|Xs,0,js|Ws,zs|Xs,0|Gs,js|Gs,zs|Xs,0|Ws,Vs|Ws,Vs|Ws,0,js|Xs,Vs|Gs,0|Xs,js|Gs,Vs|Gs,0|zs,zs|Gs,0|Ws,Vs|Ws,js|Gs,Vs|Xs,0|js,0|Xs,zs|Ws,0|js,zs|Gs,0|zs,0|Xs,zs|Ws,Vs|Xs,js|Gs,0|Vs,js|Xs,Vs|Gs,0,Vs|Ws,0|Ws,0|Gs,0|Vs,js|Xs,0|Gs,js|Ws,zs|Xs,0,Vs|Gs,0|zs,js|Ws,zs|Xs],cn=[0|(js=1<<21),(Vs=js|(zs=1<<26))|(Ws=2),zs|(Xs=Ws|(Gs=2048)),0,0|Gs,zs|Xs,js|Xs,Vs|Gs,Vs|Xs,0|js,0,zs|Ws,0|Ws,0|zs,Vs|Ws,0|Xs,zs|Gs,js|Xs,js|Ws,zs|Gs,zs|Ws,0|Vs,Vs|Gs,js|Ws,0|Vs,0|Gs,0|Xs,Vs|Xs,js|Gs,0|Ws,0|zs,js|Gs,0|zs,js|Gs,0|js,zs|Xs,zs|Xs,Vs|Ws,Vs|Ws,0|Ws,js|Ws,0|zs,zs|Gs,0|js,Vs|Gs,0|Xs,js|Xs,Vs|Gs,0|Xs,zs|Ws,Vs|Xs,0|Vs,js|Gs,0,0|Ws,Vs|Xs,0,js|Xs,0|Vs,0|Gs,zs|Ws,zs|Gs,0|Gs,js|Ws],un=[(zs=1<<28)|(Xs=(Ws=64)|(Gs=4096)),0|Gs,0|(js=1<<18),(Vs=js|zs)|Xs,0|zs,zs|Xs,0|Ws,0|zs,js|Ws,0|Vs,Vs|Xs,js|Gs,Vs|Gs,js|Xs,0|Gs,0|Ws,0|Vs,zs|Ws,zs|Gs,0|Xs,js|Gs,js|Ws,Vs|Ws,Vs|Gs,0|Xs,0,0,Vs|Ws,zs|Ws,zs|Gs,js|Xs,0|js,js|Xs,0|js,Vs|Gs,0|Gs,0|Ws,Vs|Ws,0|Gs,js|Xs,zs|Gs,0|Ws,zs|Ws,0|Vs,Vs|Ws,0|zs,0|js,zs|Xs,0,Vs|Xs,js|Ws,zs|Ws,0|Vs,zs|Gs,zs|Xs,0,Vs|Xs,js|Gs,js|Gs,0|Xs,0|Xs,js|Ws,0|zs,Vs|Gs],ln=function(){function e(t){Object(o.a)(this,e),this.keys=[];for(var i=[],s=[],n=[],r=0,a=56;r<56;++r,a-=8){var h=7&(a+=a<-5?65:a<-3?31:a<-1?63:27===a?35:0);i[r]=0!==(t[a>>>3]&1<<h)?1:0}for(var c=0;c<16;++c){var u=c<<1,l=u+1;n[u]=n[l]=0;for(var d=28;d<59;d+=28)for(var _=d-28;_<d;++_){var f=_+tn[c];s[_]=f<d?i[f]:i[f-28]}for(var v=0;v<24;++v)0!==s[en[v]]&&(n[u]|=1<<23-v),0!==s[en[v+24]]&&(n[l]|=1<<23-v)}for(var p=0,m=0,g=0;p<16;++p){var y=n[m++],k=n[m++];this.keys[g]=(16515072&y)<<6,this.keys[g]|=(4032&y)<<10,this.keys[g]|=(16515072&k)>>>10,this.keys[g]|=(4032&k)>>>6,++g,this.keys[g]=(258048&y)<<12,this.keys[g]|=(63&y)<<16,this.keys[g]|=(258048&k)>>>4,this.keys[g]|=63&k,++g}}return Object(h.a)(e,[{key:"enc8",value:function(e){var t,i,s,n=e.slice(),r=0;t=n[r++]<<24|n[r++]<<16|n[r++]<<8|n[r++],i=n[r++]<<24|n[r++]<<16|n[r++]<<8|n[r++],i^=s=252645135&(t>>>4^i),i^=s=65535&((t^=s<<4)>>>16^i),i^=(s=858993459&(i>>>2^(t^=s<<16)))<<2,i=(i^=(s=16711935&(i>>>8^(t^=s)))<<8)<<1|i>>>31&1,i^=s=2863311530&((t^=s)^i),t=(t^=s)<<1|t>>>31&1;for(var a=0,o=0;a<8;++a){s=i<<28|i>>>4,s^=this.keys[o++];var h=cn[63&s];h|=on[s>>>8&63],h|=rn[s>>>16&63],h|=sn[s>>>24&63],s=i^this.keys[o++],h|=un[63&s],h|=hn[s>>>8&63],h|=an[s>>>16&63],s=(t^=h|=nn[s>>>24&63])<<28|t>>>4,s^=this.keys[o++],h=cn[63&s],h|=on[s>>>8&63],h|=rn[s>>>16&63],h|=sn[s>>>24&63],s=t^this.keys[o++],h|=un[63&s],h|=hn[s>>>8&63],h|=an[s>>>16&63],i^=h|=nn[s>>>24&63]}for(i=i<<31|i>>>1,i^=s=2863311530&(t^i),i^=s=16711935&((t=(t^=s)<<31|t>>>1)>>>8^i),i^=s=858993459&((t^=s<<8)>>>2^i),i^=(s=65535&(i>>>16^(t^=s<<2)))<<16,s=[i^=(s=252645135&(i>>>4^(t^=s)))<<4,t^=s],r=0;r<8;r++)n[r]=(s[r>>>2]>>>8*(3-r%4))%256,n[r]<0&&(n[r]+=256);return n}},{key:"encrypt",value:function(e){return this.enc8(e.slice(0,8)).concat(this.enc8(e.slice(8,16)))}}]),e}(),dn={Again:57349,AltLeft:56,AltRight:57400,ArrowDown:57424,ArrowLeft:57419,ArrowRight:57421,ArrowUp:57416,AudioVolumeDown:57390,AudioVolumeMute:57376,AudioVolumeUp:57392,Backquote:41,Backslash:43,Backspace:14,BracketLeft:26,BracketRight:27,BrowserBack:57450,BrowserFavorites:57446,BrowserForward:57449,BrowserHome:57394,BrowserRefresh:57447,BrowserSearch:57445,BrowserStop:57448,CapsLock:58,Comma:51,ContextMenu:57437,ControlLeft:29,ControlRight:57373,Convert:121,Copy:57464,Cut:57404,Delete:57427,Digit0:11,Digit1:2,Digit2:3,Digit3:4,Digit4:5,Digit5:6,Digit6:7,Digit7:8,Digit8:9,Digit9:10,Eject:57469,End:57423,Enter:28,Equal:13,Escape:1,F1:59,F10:68,F11:87,F12:88,F13:93,F14:94,F15:95,F16:85,F17:57347,F18:57463,F19:57348,F2:60,F20:90,F21:116,F22:57465,F23:109,F24:111,F3:61,F4:62,F5:63,F6:64,F7:65,F8:66,F9:67,Find:57409,Help:57461,Hiragana:119,Home:57415,Insert:57426,IntlBackslash:86,IntlRo:115,IntlYen:125,KanaMode:112,Katakana:120,KeyA:30,KeyB:48,KeyC:46,KeyD:32,KeyE:18,KeyF:33,KeyG:34,KeyH:35,KeyI:23,KeyJ:36,KeyK:37,KeyL:38,KeyM:50,KeyN:49,KeyO:24,KeyP:25,KeyQ:16,KeyR:19,KeyS:31,KeyT:20,KeyU:22,KeyV:47,KeyW:17,KeyX:45,KeyY:21,KeyZ:44,Lang3:120,Lang4:119,Lang5:118,LaunchApp1:57451,LaunchApp2:57377,LaunchMail:57452,MediaPlayPause:57378,MediaSelect:57453,MediaStop:57380,MediaTrackNext:57369,MediaTrackPrevious:57360,MetaLeft:57435,MetaRight:57436,Minus:12,NonConvert:123,NumLock:69,Numpad0:82,Numpad1:79,Numpad2:80,Numpad3:81,Numpad4:75,Numpad5:76,Numpad6:77,Numpad7:71,Numpad8:72,Numpad9:73,NumpadAdd:78,NumpadComma:126,NumpadDecimal:83,NumpadDivide:57397,NumpadEnter:57372,NumpadEqual:89,NumpadMultiply:55,NumpadParenLeft:57462,NumpadParenRight:57467,NumpadSubtract:74,Open:100,PageDown:57425,PageUp:57417,Paste:101,Pause:57414,Period:52,Power:57438,PrintScreen:84,Props:57350,Quote:40,ScrollLock:70,Semicolon:39,ShiftLeft:42,ShiftRight:54,Slash:53,Sleep:57439,Space:57,Suspend:57381,Tab:15,Undo:57351,WakeUp:57443},_n={encodingRaw:0,encodingCopyRect:1,encodingRRE:2,encodingHextile:5,encodingTight:7,encodingTightPNG:-260,pseudoEncodingQualityLevel9:-23,pseudoEncodingQualityLevel0:-32,pseudoEncodingDesktopSize:-223,pseudoEncodingLastRect:-224,pseudoEncodingCursor:-239,pseudoEncodingQEMUExtendedKeyEvent:-258,pseudoEncodingDesktopName:-307,pseudoEncodingExtendedDesktopSize:-308,pseudoEncodingXvp:-309,pseudoEncodingFence:-312,pseudoEncodingContinuousUpdates:-313,pseudoEncodingCompressLevel9:-247,pseudoEncodingCompressLevel0:-256,pseudoEncodingVMwareCursor:1464686180};i(19);var fn=function(){function e(){Object(o.a)(this,e),this._lines=0}return Object(h.a)(e,[{key:"decodeRect",value:function(e,t,i,s,n,r,a){0===this._lines&&(this._lines=s);var o=i*(8==a?1:4);if(n.rQwait("RAW",o))return!1;var h=t+(s-this._lines),c=Math.min(this._lines,Math.floor(n.rQlen/o)),u=n.rQ,l=n.rQi;if(8==a){for(var d=i*c,_=new Uint8Array(4*d),f=0;f<d;f++)_[4*f+0]=255*(u[l+f]>>0&3)/3,_[4*f+1]=255*(u[l+f]>>2&3)/3,_[4*f+2]=255*(u[l+f]>>4&3)/3,_[4*f+4]=0;u=_,l=0}return r.blitImage(e,h,i,c,u,l),n.rQskipBytes(c*o),this._lines-=c,!(this._lines>0)}}]),e}(),vn=function(){function e(){Object(o.a)(this,e)}return Object(h.a)(e,[{key:"decodeRect",value:function(e,t,i,s,n,r,a){if(n.rQwait("COPYRECT",4))return!1;var o=n.rQshift16(),h=n.rQshift16();return r.copyImage(o,h,e,t,i,s),!0}}]),e}(),pn=function(){function e(){Object(o.a)(this,e),this._subrects=0}return Object(h.a)(e,[{key:"decodeRect",value:function(e,t,i,s,n,r,a){if(0===this._subrects){if(n.rQwait("RRE",8))return!1;this._subrects=n.rQshift32();var o=n.rQshiftBytes(4);r.fillRect(e,t,i,s,o)}for(;this._subrects>0;){if(n.rQwait("RRE",12))return!1;var h=n.rQshiftBytes(4),c=n.rQshift16(),u=n.rQshift16(),l=n.rQshift16(),d=n.rQshift16();r.fillRect(e+c,t+u,l,d,h),this._subrects--}return!0}}]),e}(),mn=function(){function e(){Object(o.a)(this,e),this._tiles=0,this._lastsubencoding=0}return Object(h.a)(e,[{key:"decodeRect",value:function(e,t,i,s,n,r,a){for(0===this._tiles&&(this._tiles_x=Math.ceil(i/16),this._tiles_y=Math.ceil(s/16),this._total_tiles=this._tiles_x*this._tiles_y,this._tiles=this._total_tiles);this._tiles>0;){var o=1;if(n.rQwait("HEXTILE",o))return!1;var h=n.rQ,c=n.rQi,u=h[c];if(u>30)throw new Error("Illegal hextile subencoding (subencoding: "+u+")");var l=this._total_tiles-this._tiles,d=e+16*(l%this._tiles_x),_=t+16*Math.floor(l/this._tiles_x),f=Math.min(16,e+i-d),v=Math.min(16,t+s-_);if(1&u)o+=f*v*4;else if(2&u&&(o+=4),4&u&&(o+=4),8&u){if(o++,n.rQwait("HEXTILE",o))return!1;var m=h[c+o-1];o+=16&u?6*m:2*m}if(n.rQwait("HEXTILE",o))return!1;if(c++,0===u)1&this._lastsubencoding?p("     Ignoring blank after RAW"):r.fillRect(d,_,f,v,this._background);else if(1&u)r.blitImage(d,_,f,v,h,c),c+=o-1;else{if(2&u&&(this._background=[h[c],h[c+1],h[c+2],h[c+3]],c+=4),4&u&&(this._foreground=[h[c],h[c+1],h[c+2],h[c+3]],c+=4),r.startTile(d,_,f,v,this._background),8&u){var g=h[c];c++;for(var y=0;y<g;y++){var k=void 0;16&u?(k=[h[c],h[c+1],h[c+2],h[c+3]],c+=4):k=this._foreground;var w=h[c],b=w>>4,E=15&w,C=h[++c];c++;var S=1+(C>>4),Q=1+(15&C);r.subTile(b,E,S,Q,k)}}r.finishTile()}n.rQi=c,this._lastsubencoding=u,this._tiles--}return!0}}]),e}();function gn(e,t,i,s,n){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+s),n);else for(var r=0;r<s;r++)e[n+r]=t[i+r]}var yn=Uint8Array,kn=Uint16Array,wn=Int32Array;function bn(e,t,i,s){for(var n=65535&e|0,r=e>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{r=r+(n=n+t[s++]|0)|0}while(--a);n%=65521,r%=65521}return n|r<<16|0}function En(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}En();var Cn=30,Sn=12;function Qn(e,t){var i,s,n,r,a,o,h,c,u,l,d,_,f,v,p,m,g,y,k,w,b,E,C,S,Q;i=e.state,s=e.next_in,S=e.input,n=s+(e.avail_in-5),r=e.next_out,Q=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),h=i.dmax,c=i.wsize,u=i.whave,l=i.wnext,d=i.window,_=i.hold,f=i.bits,v=i.lencode,p=i.distcode,m=(1<<i.lenbits)-1,g=(1<<i.distbits)-1;e:do{f<15&&(_+=S[s++]<<f,f+=8,_+=S[s++]<<f,f+=8),y=v[_&m];t:for(;;){if(_>>>=k=y>>>24,f-=k,0===(k=y>>>16&255))Q[r++]=65535&y;else{if(!(16&k)){if(0===(64&k)){y=v[(65535&y)+(_&(1<<k)-1)];continue t}if(32&k){i.mode=Sn;break e}e.msg="invalid literal/length code",i.mode=Cn;break e}w=65535&y,(k&=15)&&(f<k&&(_+=S[s++]<<f,f+=8),w+=_&(1<<k)-1,_>>>=k,f-=k),f<15&&(_+=S[s++]<<f,f+=8,_+=S[s++]<<f,f+=8),y=p[_&g];i:for(;;){if(_>>>=k=y>>>24,f-=k,!(16&(k=y>>>16&255))){if(0===(64&k)){y=p[(65535&y)+(_&(1<<k)-1)];continue i}e.msg="invalid distance code",i.mode=Cn;break e}if(b=65535&y,f<(k&=15)&&(_+=S[s++]<<f,(f+=8)<k&&(_+=S[s++]<<f,f+=8)),(b+=_&(1<<k)-1)>h){e.msg="invalid distance too far back",i.mode=Cn;break e}if(_>>>=k,f-=k,b>(k=r-a)){if((k=b-k)>u&&i.sane){e.msg="invalid distance too far back",i.mode=Cn;break e}if(E=0,C=d,0===l){if(E+=c-k,k<w){w-=k;do{Q[r++]=d[E++]}while(--k);E=r-b,C=Q}}else if(l<k){if(E+=c+l-k,(k-=l)<w){w-=k;do{Q[r++]=d[E++]}while(--k);if(E=0,l<w){w-=k=l;do{Q[r++]=d[E++]}while(--k);E=r-b,C=Q}}}else if(E+=l-k,k<w){w-=k;do{Q[r++]=d[E++]}while(--k);E=r-b,C=Q}for(;w>2;)Q[r++]=C[E++],Q[r++]=C[E++],Q[r++]=C[E++],w-=3;w&&(Q[r++]=C[E++],w>1&&(Q[r++]=C[E++]))}else{E=r-b;do{Q[r++]=Q[E++],Q[r++]=Q[E++],Q[r++]=Q[E++],w-=3}while(w>2);w&&(Q[r++]=Q[E++],w>1&&(Q[r++]=Q[E++]))}break}}break}}while(s<n&&r<o);s-=w=f>>3,_&=(1<<(f-=w<<3))-1,e.next_in=s,e.next_out=r,e.avail_in=s<n?n-s+5:5-(s-n),e.avail_out=r<o?o-r+257:257-(r-o),i.hold=_,i.bits=f}var xn=15,An=852,Fn=592,Dn=0,Bn=1,Rn=2,Ln=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Tn=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Mn=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Un=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function On(e,t,i,s,n,r,a,o){var h,c,u,l,d,_,f,v,p,m=o.bits,g=0,y=0,k=0,w=0,b=0,E=0,C=0,S=0,Q=0,x=0,A=null,F=0,D=new kn(xn+1),B=new kn(xn+1),R=null,L=0;for(g=0;g<=xn;g++)D[g]=0;for(y=0;y<s;y++)D[t[i+y]]++;for(b=m,w=xn;w>=1&&0===D[w];w--);if(b>w&&(b=w),0===w)return n[r++]=20971520,n[r++]=20971520,o.bits=1,0;for(k=1;k<w&&0===D[k];k++);for(b<k&&(b=k),S=1,g=1;g<=xn;g++)if(S<<=1,(S-=D[g])<0)return-1;if(S>0&&(e===Dn||1!==w))return-1;for(B[1]=0,g=1;g<xn;g++)B[g+1]=B[g]+D[g];for(y=0;y<s;y++)0!==t[i+y]&&(a[B[t[i+y]]++]=y);if(e===Dn?(A=R=a,_=19):e===Bn?(A=Ln,F-=257,R=Tn,L-=257,_=256):(A=Mn,R=Un,_=-1),x=0,y=0,g=k,d=r,E=b,C=0,u=-1,l=(Q=1<<b)-1,e===Bn&&Q>An||e===Rn&&Q>Fn)return 1;for(;;){f=g-C,a[y]<_?(v=0,p=a[y]):a[y]>_?(v=R[L+a[y]],p=A[F+a[y]]):(v=96,p=0),h=1<<g-C,k=c=1<<E;do{n[d+(x>>C)+(c-=h)]=f<<24|v<<16|p|0}while(0!==c);for(h=1<<g-1;x&h;)h>>=1;if(0!==h?(x&=h-1,x+=h):x=0,y++,0===--D[g]){if(g===w)break;g=t[i+a[y]]}if(g>b&&(x&l)!==u){for(0===C&&(C=b),d+=k,S=1<<(E=g-C);E+C<w&&!((S-=D[E+C])<=0);)E++,S<<=1;if(Q+=1<<E,e===Bn&&Q>An||e===Rn&&Q>Fn)return 1;n[u=x&l]=b<<24|E<<16|d-r|0}}return 0!==x&&(n[d+x]=g-C<<24|64<<16|0),o.bits=b,0}var In=0,Pn=1,Nn=2,Kn=4,Hn=5,jn=6,zn=0,Vn=1,Wn=2,Gn=-2,Xn=-3,Yn=-4,qn=-5,Zn=8,Jn=1,$n=2,er=3,tr=4,ir=5,sr=6,nr=7,rr=8,ar=9,or=10,hr=11,cr=12,ur=13,lr=14,dr=15,_r=16,fr=17,vr=18,pr=19,mr=20,gr=21,yr=22,kr=23,wr=24,br=25,Er=26,Cr=27,Sr=28,Qr=29,xr=30,Ar=31,Fr=32,Dr=852,Br=592,Rr=15;function Lr(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Tr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new kn(320),this.work=new kn(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Mr(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,function(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Jn,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new wn(Dr),t.distcode=t.distdyn=new wn(Br),t.sane=1,t.back=-1,zn):Gn}(e)):Gn}function Ur(e,t){var i,s;return e?(s=new Tr,e.state=s,s.window=null,(i=function(e,t){var i,s;return e&&e.state?(s=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Gn:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=i,s.wbits=t,Mr(e))):Gn}(e,t))!==zn&&(e.state=null),i):Gn}var Or,Ir,Pr=!0;function Nr(e){if(Pr){var t;for(Or=new wn(512),Ir=new wn(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(On(Pn,e.lens,0,288,Or,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;On(Nn,e.lens,0,32,Ir,0,e.work,{bits:5}),Pr=!1}e.lencode=Or,e.lenbits=9,e.distcode=Ir,e.distbits=5}function Kr(e,t,i,s){var n,r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new yn(r.wsize)),s>=r.wsize?(gn(r.window,t,i-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):((n=r.wsize-r.wnext)>s&&(n=s),gn(r.window,t,i-s,n,r.wnext),(s-=n)?(gn(r.window,t,i-s,s,0),r.wnext=s,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0}function Hr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var jr=function(){function e(){var t;Object(o.a)(this,e),this.strm=new Hr,this.chunkSize=102400,this.strm.output=new Uint8Array(this.chunkSize),this.windowBits=5,t=this.strm,this.windowBits,Ur(t,Rr)}return Object(h.a)(e,[{key:"inflate",value:function(e,t,i){return this.strm.input=e,this.strm.avail_in=this.strm.input.length,this.strm.next_in=0,this.strm.next_out=0,i>this.chunkSize&&(this.chunkSize=i,this.strm.output=new Uint8Array(this.chunkSize)),this.strm.avail_out=this.chunkSize,function(e,t){var i,s,n,r,a,o,h,c,u,l,d,_,f,v,p,m,g,y,k,w,b,E,C,S,Q=0,x=new yn(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Gn;(i=e.state).mode===cr&&(i.mode=ur),a=e.next_out,n=e.output,h=e.avail_out,r=e.next_in,s=e.input,o=e.avail_in,c=i.hold,u=i.bits,l=o,d=h,E=zn;e:for(;;)switch(i.mode){case Jn:if(0===i.wrap){i.mode=ur;break}for(;u<16;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(2&i.wrap&&35615===c){i.check=0,x[0]=255&c,x[1]=c>>>8&255,i.check=En(i.check),c=0,u=0,i.mode=$n;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",i.mode=xr;break}if((15&c)!==Zn){e.msg="unknown compression method",i.mode=xr;break}if(u-=4,b=8+(15&(c>>>=4)),0===i.wbits)i.wbits=b;else if(b>i.wbits){e.msg="invalid window size",i.mode=xr;break}i.dmax=1<<b,e.adler=i.check=1,i.mode=512&c?or:cr,c=0,u=0;break;case $n:for(;u<16;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(i.flags=c,(255&i.flags)!==Zn){e.msg="unknown compression method",i.mode=xr;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=xr;break}i.head&&(i.head.text=c>>8&1),512&i.flags&&(x[0]=255&c,x[1]=c>>>8&255,i.check=En(i.check)),c=0,u=0,i.mode=er;case er:for(;u<32;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}i.head&&(i.head.time=c),512&i.flags&&(x[0]=255&c,x[1]=c>>>8&255,x[2]=c>>>16&255,x[3]=c>>>24&255,i.check=En(i.check)),c=0,u=0,i.mode=tr;case tr:for(;u<16;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}i.head&&(i.head.xflags=255&c,i.head.os=c>>8),512&i.flags&&(x[0]=255&c,x[1]=c>>>8&255,i.check=En(i.check)),c=0,u=0,i.mode=ir;case ir:if(1024&i.flags){for(;u<16;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}i.length=c,i.head&&(i.head.extra_len=c),512&i.flags&&(x[0]=255&c,x[1]=c>>>8&255,i.check=En(i.check)),c=0,u=0}else i.head&&(i.head.extra=null);i.mode=sr;case sr:if(1024&i.flags&&((_=i.length)>o&&(_=o),_&&(i.head&&(b=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),gn(i.head.extra,s,r,_,b)),512&i.flags&&(i.check=En(i.check)),o-=_,r+=_,i.length-=_),i.length))break e;i.length=0,i.mode=nr;case nr:if(2048&i.flags){if(0===o)break e;_=0;do{b=s[r+_++],i.head&&b&&i.length<65536&&(i.head.name+=String.fromCharCode(b))}while(b&&_<o);if(512&i.flags&&(i.check=En(i.check)),o-=_,r+=_,b)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=rr;case rr:if(4096&i.flags){if(0===o)break e;_=0;do{b=s[r+_++],i.head&&b&&i.length<65536&&(i.head.comment+=String.fromCharCode(b))}while(b&&_<o);if(512&i.flags&&(i.check=En(i.check)),o-=_,r+=_,b)break e}else i.head&&(i.head.comment=null);i.mode=ar;case ar:if(512&i.flags){for(;u<16;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(c!==(65535&i.check)){e.msg="header crc mismatch",i.mode=xr;break}c=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=cr;break;case or:for(;u<32;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}e.adler=i.check=Lr(c),c=0,u=0,i.mode=hr;case hr:if(0===i.havedict)return e.next_out=a,e.avail_out=h,e.next_in=r,e.avail_in=o,i.hold=c,i.bits=u,Wn;e.adler=i.check=1,i.mode=cr;case cr:if(t===Hn||t===jn)break e;case ur:if(i.last){c>>>=7&u,u-=7&u,i.mode=Cr;break}for(;u<3;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}switch(i.last=1&c,u-=1,3&(c>>>=1)){case 0:i.mode=lr;break;case 1:if(Nr(i),i.mode=mr,t===jn){c>>>=2,u-=2;break e}break;case 2:i.mode=fr;break;case 3:e.msg="invalid block type",i.mode=xr}c>>>=2,u-=2;break;case lr:for(c>>>=7&u,u-=7&u;u<32;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if((65535&c)!==(c>>>16^65535)){e.msg="invalid stored block lengths",i.mode=xr;break}if(i.length=65535&c,c=0,u=0,i.mode=dr,t===jn)break e;case dr:i.mode=_r;case _r:if(_=i.length){if(_>o&&(_=o),_>h&&(_=h),0===_)break e;gn(n,s,r,_,a),o-=_,r+=_,h-=_,a+=_,i.length-=_;break}i.mode=cr;break;case fr:for(;u<14;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(i.nlen=257+(31&c),c>>>=5,u-=5,i.ndist=1+(31&c),c>>>=5,u-=5,i.ncode=4+(15&c),c>>>=4,u-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=xr;break}i.have=0,i.mode=vr;case vr:for(;i.have<i.ncode;){for(;u<3;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}i.lens[A[i.have++]]=7&c,c>>>=3,u-=3}for(;i.have<19;)i.lens[A[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},E=On(In,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,E){e.msg="invalid code lengths set",i.mode=xr;break}i.have=0,i.mode=pr;case pr:for(;i.have<i.nlen+i.ndist;){for(;m=(Q=i.lencode[c&(1<<i.lenbits)-1])>>>16&255,g=65535&Q,!((p=Q>>>24)<=u);){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(g<16)c>>>=p,u-=p,i.lens[i.have++]=g;else{if(16===g){for(S=p+2;u<S;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(c>>>=p,u-=p,0===i.have){e.msg="invalid bit length repeat",i.mode=xr;break}b=i.lens[i.have-1],_=3+(3&c),c>>>=2,u-=2}else if(17===g){for(S=p+3;u<S;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}u-=p,b=0,_=3+(7&(c>>>=p)),c>>>=3,u-=3}else{for(S=p+7;u<S;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}u-=p,b=0,_=11+(127&(c>>>=p)),c>>>=7,u-=7}if(i.have+_>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=xr;break}for(;_--;)i.lens[i.have++]=b}}if(i.mode===xr)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=xr;break}if(i.lenbits=9,C={bits:i.lenbits},E=On(Pn,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,E){e.msg="invalid literal/lengths set",i.mode=xr;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},E=On(Nn,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,E){e.msg="invalid distances set",i.mode=xr;break}if(i.mode=mr,t===jn)break e;case mr:i.mode=gr;case gr:if(o>=6&&h>=258){e.next_out=a,e.avail_out=h,e.next_in=r,e.avail_in=o,i.hold=c,i.bits=u,Qn(e,d),a=e.next_out,n=e.output,h=e.avail_out,r=e.next_in,s=e.input,o=e.avail_in,c=i.hold,u=i.bits,i.mode===cr&&(i.back=-1);break}for(i.back=0;m=(Q=i.lencode[c&(1<<i.lenbits)-1])>>>16&255,g=65535&Q,!((p=Q>>>24)<=u);){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(m&&0===(240&m)){for(y=p,k=m,w=g;m=(Q=i.lencode[w+((c&(1<<y+k)-1)>>y)])>>>16&255,g=65535&Q,!(y+(p=Q>>>24)<=u);){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}c>>>=y,u-=y,i.back+=y}if(c>>>=p,u-=p,i.back+=p,i.length=g,0===m){i.mode=Er;break}if(32&m){i.back=-1,i.mode=cr;break}if(64&m){e.msg="invalid literal/length code",i.mode=xr;break}i.extra=15&m,i.mode=yr;case yr:if(i.extra){for(S=i.extra;u<S;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=kr;case kr:for(;m=(Q=i.distcode[c&(1<<i.distbits)-1])>>>16&255,g=65535&Q,!((p=Q>>>24)<=u);){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(0===(240&m)){for(y=p,k=m,w=g;m=(Q=i.distcode[w+((c&(1<<y+k)-1)>>y)])>>>16&255,g=65535&Q,!(y+(p=Q>>>24)<=u);){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}c>>>=y,u-=y,i.back+=y}if(c>>>=p,u-=p,i.back+=p,64&m){e.msg="invalid distance code",i.mode=xr;break}i.offset=g,i.extra=15&m,i.mode=wr;case wr:if(i.extra){for(S=i.extra;u<S;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=xr;break}i.mode=br;case br:if(0===h)break e;if(_=d-h,i.offset>_){if((_=i.offset-_)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=xr;break}_>i.wnext?(_-=i.wnext,f=i.wsize-_):f=i.wnext-_,_>i.length&&(_=i.length),v=i.window}else v=n,f=a-i.offset,_=i.length;_>h&&(_=h),h-=_,i.length-=_;do{n[a++]=v[f++]}while(--_);0===i.length&&(i.mode=gr);break;case Er:if(0===h)break e;n[a++]=i.length,h--,i.mode=gr;break;case Cr:if(i.wrap){for(;u<32;){if(0===o)break e;o--,c|=s[r++]<<u,u+=8}if(d-=h,e.total_out+=d,i.total+=d,d&&(e.adler=i.check=i.flags?En(i.check):bn(i.check,n,d,a-d)),d=h,(i.flags?c:Lr(c))!==i.check){e.msg="incorrect data check",i.mode=xr;break}c=0,u=0}i.mode=Sr;case Sr:if(i.wrap&&i.flags){for(;u<32;){if(0===o)break e;o--,c+=s[r++]<<u,u+=8}if(c!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=xr;break}c=0,u=0}i.mode=Qr;case Qr:E=Vn;break e;case xr:E=Xn;break e;case Ar:return Yn;case Fr:default:return Gn}e.next_out=a,e.avail_out=h,e.next_in=r,e.avail_in=o,i.hold=c,i.bits=u,(i.wsize||d!==e.avail_out&&i.mode<xr&&(i.mode<Cr||t!==Kn))&&Kr(e,e.output,e.next_out,d-e.avail_out)?i.mode=Ar:(l-=e.avail_in,d-=e.avail_out,e.total_in+=l,e.total_out+=d,i.total+=d,i.wrap&&d&&(e.adler=i.check=i.flags?En(i.check,e.next_out):bn(i.check,n,d,e.next_out-d)),e.data_type=i.bits+(i.last?64:0)+(i.mode===cr?128:0)+(i.mode===mr||i.mode===dr?256:0),(0===l&&0===d||t===Kn)&&E===zn&&(E=qn))}(this.strm,t),new Uint8Array(this.strm.output.buffer,0,this.strm.next_out)}},{key:"reset",value:function(){Mr(this.strm)}}]),e}(),zr=function(){function e(){Object(o.a)(this,e),this._ctl=null,this._filter=null,this._numColors=0,this._palette=new Uint8Array(1024),this._len=0,this._zlibs=[];for(var t=0;t<4;t++)this._zlibs[t]=new jr}return Object(h.a)(e,[{key:"decodeRect",value:function(e,t,i,s,n,r,a){if(null===this._ctl){if(n.rQwait("TIGHT compression-control",1))return!1;this._ctl=n.rQshift8();for(var o=0;o<4;o++)this._ctl>>o&1&&(this._zlibs[o].reset(),m("Reset zlib stream "+o));this._ctl=this._ctl>>4}var h;if(8===this._ctl)h=this._fillRect(e,t,i,s,n,r,a);else if(9===this._ctl)h=this._jpegRect(e,t,i,s,n,r,a);else if(10===this._ctl)h=this._pngRect(e,t,i,s,n,r,a);else{if(0!=(128&this._ctl))throw new Error("Illegal tight compression received (ctl: "+this._ctl+")");h=this._basicRect(this._ctl,e,t,i,s,n,r,a)}return h&&(this._ctl=null),h}},{key:"_fillRect",value:function(e,t,i,s,n,r,a){if(n.rQwait("TIGHT",3))return!1;var o=n.rQi,h=n.rQ;return r.fillRect(e,t,i,s,[h[o+2],h[o+1],h[o]],!1),n.rQskipBytes(3),!0}},{key:"_jpegRect",value:function(e,t,i,s,n,r,a){var o=this._readData(n);return null!==o&&(r.imageRect(e,t,"image/jpeg",o),!0)}},{key:"_pngRect",value:function(e,t,i,s,n,r,a){throw new Error("PNG received in standard Tight rect")}},{key:"_basicRect",value:function(e,t,i,s,n,r,a,o){if(null===this._filter)if(4&e){if(r.rQwait("TIGHT",1))return!1;this._filter=r.rQshift8()}else this._filter=0;var h,c=3&e;switch(this._filter){case 0:h=this._copyFilter(c,t,i,s,n,r,a,o);break;case 1:h=this._paletteFilter(c,t,i,s,n,r,a,o);break;case 2:h=this._gradientFilter(c,t,i,s,n,r,a,o);break;default:throw new Error("Illegal tight filter received (ctl: "+this._filter+")")}return h&&(this._filter=null),h}},{key:"_copyFilter",value:function(e,t,i,s,n,r,a,o){var h,c=s*n*3;if(c<12){if(r.rQwait("TIGHT",c))return!1;h=r.rQshiftBytes(c)}else{if(null===(h=this._readData(r)))return!1;if((h=this._zlibs[e].inflate(h,!0,c)).length!=c)throw new Error("Incomplete zlib block")}return a.blitRgbImage(t,i,s,n,h,0,!1),!0}},{key:"_paletteFilter",value:function(e,t,i,s,n,r,a,o){if(0===this._numColors){if(r.rQwait("TIGHT palette",1))return!1;var h=r.rQpeek8()+1,c=3*h;if(r.rQwait("TIGHT palette",1+c))return!1;this._numColors=h,r.rQskipBytes(1),r.rQshiftTo(this._palette,c)}var u,l=this._numColors<=2?1:8,d=Math.floor((s*l+7)/8)*n;if(d<12){if(r.rQwait("TIGHT",d))return!1;u=r.rQshiftBytes(d)}else{if(null===(u=this._readData(r)))return!1;if((u=this._zlibs[e].inflate(u,!0,d)).length!=d)throw new Error("Incomplete zlib block")}return 2==this._numColors?this._monoRect(t,i,s,n,u,this._palette,a):this._paletteRect(t,i,s,n,u,this._palette,a),this._numColors=0,!0}},{key:"_monoRect",value:function(e,t,i,s,n,r,a){for(var o=this._getScratchBuffer(i*s*4),h=Math.floor((i+7)/8),c=Math.floor(i/8),u=0;u<s;u++){var l=void 0,d=void 0,_=void 0;for(_=0;_<c;_++)for(var f=7;f>=0;f--)l=4*(u*i+8*_+7-f),d=3*(n[u*h+_]>>f&1),o[l]=r[d],o[l+1]=r[d+1],o[l+2]=r[d+2],o[l+3]=255;for(var v=7;v>=8-i%8;v--)l=4*(u*i+8*_+7-v),d=3*(n[u*h+_]>>v&1),o[l]=r[d],o[l+1]=r[d+1],o[l+2]=r[d+2],o[l+3]=255}a.blitRgbxImage(e,t,i,s,o,0,!1)}},{key:"_paletteRect",value:function(e,t,i,s,n,r,a){for(var o=this._getScratchBuffer(i*s*4),h=i*s*4,c=0,u=0;c<h;c+=4,u++){var l=3*n[u];o[c]=r[l],o[c+1]=r[l+1],o[c+2]=r[l+2],o[c+3]=255}a.blitRgbxImage(e,t,i,s,o,0,!1)}},{key:"_gradientFilter",value:function(e,t,i,s,n,r,a,o){throw new Error("Gradient filter not implemented")}},{key:"_readData",value:function(e){if(0===this._len){if(e.rQwait("TIGHT",3))return null;var t;t=e.rQshift8(),this._len=127&t,128&t&&(t=e.rQshift8(),this._len|=(127&t)<<7,128&t&&(t=e.rQshift8(),this._len|=t<<14))}if(e.rQwait("TIGHT",this._len))return null;var i=e.rQshiftBytes(this._len);return this._len=0,i}},{key:"_getScratchBuffer",value:function(e){return(!this._scratchBuffer||this._scratchBuffer.length<e)&&(this._scratchBuffer=new Uint8Array(e)),this._scratchBuffer}}]),e}(),Vr=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(h.a)(t,[{key:"_pngRect",value:function(e,t,i,s,n,r,a){var o=this._readData(n);return null!==o&&(r.imageRect(e,t,"image/png",o),!0)}},{key:"_basicRect",value:function(e,t,i,s,n,r,a,o){throw new Error("BasicCompression received in TightPNG rect")}}]),t}(zr),Wr="rgb(40, 40, 40)",Gr=function(e){function t(e,i,s){var n;if(Object(o.a)(this,t),!e)throw new Error("Must specify target");if(!i)throw new Error("Must specify URL");(n=Object(c.a)(this,Object(u.a)(t).call(this)))._target=e,n._url=i,s=s||{},n._rfb_credentials=s.credentials||{},n._shared=!("shared"in s)||!!s.shared,n._repeaterID=s.repeaterID||"",n._wsProtocols=s.wsProtocols||[],n._rfb_connection_state="",n._rfb_init_state="",n._rfb_auth_scheme=-1,n._rfb_clean_disconnect=!0,n._rfb_version=0,n._rfb_max_version=3.8,n._rfb_tightvnc=!1,n._rfb_xvp_ver=0,n._fb_width=0,n._fb_height=0,n._fb_name="",n._capabilities={power:!1},n._supportsFence=!1,n._supportsContinuousUpdates=!1,n._enabledContinuousUpdates=!1,n._supportsSetDesktopSize=!1,n._screen_id=0,n._screen_flags=0,n._qemuExtKeyEventSupported=!1,n._sock=null,n._display=null,n._flushing=!1,n._keyboard=null,n._mouse=null,n._disconnTimer=null,n._resizeTimeout=null,n._decoders={},n._FBU={rects:0,x:0,y:0,width:0,height:0,encoding:null},n._mouse_buttonMask=0,n._mouse_arr=[],n._viewportDragging=!1,n._viewportDragPos={},n._viewportHasMoved=!1,n._eventHandlers={focusCanvas:n._focusCanvas.bind(Object(f.a)(n)),windowResize:n._windowResize.bind(Object(f.a)(n))},p(">> RFB.constructor"),n._screen=document.createElement("div"),n._screen.style.display="flex",n._screen.style.width="100%",n._screen.style.height="100%",n._screen.style.overflow="auto",n._screen.style.background=Wr,n._canvas=document.createElement("canvas"),n._canvas.style.margin="auto",n._canvas.style.outline="none",n._canvas.style.flexShrink="0",n._canvas.width=0,n._canvas.height=0,n._canvas.tabIndex=-1,n._screen.appendChild(n._canvas),n._cursor=new Js,n._cursorImage=t.cursors.none,n._decoders[_n.encodingRaw]=new fn,n._decoders[_n.encodingCopyRect]=new vn,n._decoders[_n.encodingRRE]=new pn,n._decoders[_n.encodingHextile]=new mn,n._decoders[_n.encodingTight]=new zr,n._decoders[_n.encodingTightPNG]=new Vr;try{n._display=new M(n._canvas)}catch(oa){throw y("Display exception: "+oa),oa}return n._display.onflush=n._onFlush.bind(Object(f.a)(n)),n._keyboard=new Ys(n._canvas),n._keyboard.onkeyevent=n._handleKeyEvent.bind(Object(f.a)(n)),n._mouse=new qs(n._canvas),n._mouse.onmousebutton=n._handleMouseButton.bind(Object(f.a)(n)),n._mouse.onmousemove=n._handleMouseMove.bind(Object(f.a)(n)),n._sock=new $s,n._sock.on("message",(function(){n._handle_message()})),n._sock.on("open",(function(){"connecting"===n._rfb_connection_state&&""===n._rfb_init_state?(n._rfb_init_state="ProtocolVersion",p("Starting VNC handshake")):n._fail("Unexpected server connection while "+n._rfb_connection_state)})),n._sock.on("close",(function(e){p("WebSocket on-close event");var t="";switch(e.code&&(t="(code: "+e.code,e.reason&&(t+=", reason: "+e.reason),t+=")"),n._rfb_connection_state){case"connecting":n._fail("Connection closed "+t);break;case"connected":n._updateConnectionState("disconnecting"),n._updateConnectionState("disconnected");break;case"disconnecting":n._updateConnectionState("disconnected");break;case"disconnected":n._fail("Unexpected server disconnect when already disconnected "+t);break;default:n._fail("Unexpected server disconnect before connecting "+t)}n._sock.off("close")})),n._sock.on("error",(function(e){return g("WebSocket on-error event")})),setTimeout(n._updateConnectionState.bind(Object(f.a)(n),"connecting")),p("<< RFB.constructor"),n.dragViewport=!1,n.focusOnClick=!0,n._viewOnly=!1,n._clipViewport=!1,n._scaleViewport=!1,n._resizeSession=!1,n._showDotCursor=!1,void 0!==s.showDotCursor&&(g("Specifying showDotCursor as a RFB constructor argument is deprecated"),n._showDotCursor=s.showDotCursor),n}return Object(l.a)(t,e),Object(h.a)(t,[{key:"disconnect",value:function(){this._updateConnectionState("disconnecting"),this._sock.off("error"),this._sock.off("message"),this._sock.off("open")}},{key:"sendCredentials",value:function(e){this._rfb_credentials=e,setTimeout(this._init_msg.bind(this),0)}},{key:"sendCtrlAltDel",value:function(){"connected"!==this._rfb_connection_state||this._viewOnly||(m("Sending Ctrl-Alt-Del"),this.sendKey(Jt,"ControlLeft",!0),this.sendKey(ti,"AltLeft",!0),this.sendKey(ee,"Delete",!0),this.sendKey(ee,"Delete",!1),this.sendKey(ti,"AltLeft",!1),this.sendKey(Jt,"ControlLeft",!1))}},{key:"machineShutdown",value:function(){this._xvpOp(1,2)}},{key:"machineReboot",value:function(){this._xvpOp(1,3)}},{key:"machineReset",value:function(){this._xvpOp(1,4)}},{key:"sendKey",value:function(e,i,s){if("connected"===this._rfb_connection_state&&!this._viewOnly){if(void 0===s)return this.sendKey(e,i,!0),void this.sendKey(e,i,!1);var n=dn[i];if(this._qemuExtKeyEventSupported&&n)m("Sending key ("+(s?"down":"up")+"): keysym "+(e=e||0)+", scancode "+n),t.messages.QEMUExtendedKeyEvent(this._sock,e,s,n);else{if(!e)return;m("Sending keysym ("+(s?"down":"up")+"): "+e),t.messages.keyEvent(this._sock,e,s?1:0)}}}},{key:"focus",value:function(){this._canvas.focus()}},{key:"blur",value:function(){this._canvas.blur()}},{key:"clipboardPasteFrom",value:function(e){"connected"!==this._rfb_connection_state||this._viewOnly||t.messages.clientCutText(this._sock,e)}},{key:"_connect",value:function(){p(">> RFB.connect"),m("connecting to "+this._url);try{this._sock.open(this._url,this._wsProtocols)}catch(e){"SyntaxError"===e.name?this._fail("Invalid host or port ("+e+")"):this._fail("Error when opening socket ("+e+")")}this._target.appendChild(this._screen),this._cursor.attach(this._canvas),this._refreshCursor(),window.addEventListener("resize",this._eventHandlers.windowResize),this._canvas.addEventListener("mousedown",this._eventHandlers.focusCanvas),this._canvas.addEventListener("touchstart",this._eventHandlers.focusCanvas),p("<< RFB.connect")}},{key:"_disconnect",value:function(){p(">> RFB.disconnect"),this._cursor.detach(),this._canvas.removeEventListener("mousedown",this._eventHandlers.focusCanvas),this._canvas.removeEventListener("touchstart",this._eventHandlers.focusCanvas),window.removeEventListener("resize",this._eventHandlers.windowResize),this._keyboard.ungrab(),this._mouse.ungrab(),this._sock.close();try{this._target.removeChild(this._screen)}catch(e){if("NotFoundError"!==e.name)throw e}clearTimeout(this._resizeTimeout),p("<< RFB.disconnect")}},{key:"_focusCanvas",value:function(e){e.defaultPrevented||this.focusOnClick&&this.focus()}},{key:"_setDesktopName",value:function(e){this._fb_name=e,this.dispatchEvent(new CustomEvent("desktopname",{detail:{name:this._fb_name}}))}},{key:"_windowResize",value:function(e){var t=this;window.requestAnimationFrame((function(){t._updateClip(),t._updateScale()})),this._resizeSession&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(this._requestRemoteResize.bind(this),500))}},{key:"_updateClip",value:function(){var e=this._display.clipViewport,t=this._clipViewport;if(this._scaleViewport&&(t=!1),e!==t&&(this._display.clipViewport=t),t){var i=this._screenSize();this._display.viewportChangeSize(i.w,i.h),this._fixScrollbars()}}},{key:"_updateScale",value:function(){if(this._scaleViewport){var e=this._screenSize();this._display.autoscale(e.w,e.h)}else this._display.scale=1;this._fixScrollbars()}},{key:"_requestRemoteResize",value:function(){if(clearTimeout(this._resizeTimeout),this._resizeTimeout=null,this._resizeSession&&!this._viewOnly&&this._supportsSetDesktopSize){var e=this._screenSize();t.messages.setDesktopSize(this._sock,Math.floor(e.w),Math.floor(e.h),this._screen_id,this._screen_flags),p("Requested new desktop size: "+e.w+"x"+e.h)}}},{key:"_screenSize",value:function(){var e=this._screen.getBoundingClientRect();return{w:e.width,h:e.height}}},{key:"_fixScrollbars",value:function(){var e=this._screen.style.overflow;this._screen.style.overflow="hidden",this._screen.getBoundingClientRect(),this._screen.style.overflow=e}},{key:"_updateConnectionState",value:function(e){var t=this,i=this._rfb_connection_state;if(e!==i)if("disconnected"!==i){switch(e){case"connected":if("connecting"!==i)return void y("Bad transition to connected state, previous connection state: "+i);break;case"disconnected":if("disconnecting"!==i)return void y("Bad transition to disconnected state, previous connection state: "+i);break;case"connecting":if(""!==i)return void y("Bad transition to connecting state, previous connection state: "+i);break;case"disconnecting":if("connected"!==i&&"connecting"!==i)return void y("Bad transition to disconnecting state, previous connection state: "+i);break;default:return void y("Unknown connection state: "+e)}switch(this._rfb_connection_state=e,p("New state '"+e+"', was '"+i+"'."),this._disconnTimer&&"disconnecting"!==e&&(p("Clearing disconnect timer"),clearTimeout(this._disconnTimer),this._disconnTimer=null,this._sock.off("close")),e){case"connecting":this._connect();break;case"connected":this.dispatchEvent(new CustomEvent("connect",{detail:{}}));break;case"disconnecting":this._disconnect(),this._disconnTimer=setTimeout((function(){y("Disconnection timed out."),t._updateConnectionState("disconnected")}),3e3);break;case"disconnected":this.dispatchEvent(new CustomEvent("disconnect",{detail:{clean:this._rfb_clean_disconnect}}))}}else y("Tried changing state of a disconnected RFB object");else p("Already in state '"+e+"', ignoring")}},{key:"_fail",value:function(e){switch(this._rfb_connection_state){case"disconnecting":y("Failed when disconnecting: "+e);break;case"connected":y("Failed while connected: "+e);break;case"connecting":y("Failed when connecting: "+e);break;default:y("RFB failure: "+e)}return this._rfb_clean_disconnect=!1,this._updateConnectionState("disconnecting"),this._updateConnectionState("disconnected"),!1}},{key:"_setCapability",value:function(e,t){this._capabilities[e]=t,this.dispatchEvent(new CustomEvent("capabilities",{detail:{capabilities:this._capabilities}}))}},{key:"_handle_message",value:function(){if(0!==this._sock.rQlen)switch(this._rfb_connection_state){case"disconnected":y("Got data while disconnected");break;case"connected":for(;!this._flushing&&this._normal_msg()&&0!==this._sock.rQlen;);break;default:this._init_msg()}else g("handle_message called on an empty receive queue")}},{key:"_handleKeyEvent",value:function(e,t,i){this.sendKey(e,t,i)}},{key:"_handleMouseButton",value:function(e,i,s,n){if(s?this._mouse_buttonMask|=n:this._mouse_buttonMask&=~n,this.dragViewport){if(s&&!this._viewportDragging)return this._viewportDragging=!0,this._viewportDragPos={x:e,y:i},void(this._viewportHasMoved=!1);if(this._viewportDragging=!1,this._viewportHasMoved)return;t.messages.pointerEvent(this._sock,this._display.absX(e),this._display.absY(i),n)}this._viewOnly||"connected"===this._rfb_connection_state&&t.messages.pointerEvent(this._sock,this._display.absX(e),this._display.absY(i),this._mouse_buttonMask)}},{key:"_handleMouseMove",value:function(e,i){if(this._viewportDragging){var s=this._viewportDragPos.x-e,n=this._viewportDragPos.y-i;(this._viewportHasMoved||Math.abs(s)>b||Math.abs(n)>b)&&(this._viewportHasMoved=!0,this._viewportDragPos={x:e,y:i},this._display.viewportChangePos(s,n))}else this._viewOnly||"connected"===this._rfb_connection_state&&t.messages.pointerEvent(this._sock,this._display.absX(e),this._display.absY(i),this._mouse_buttonMask)}},{key:"_negotiate_protocol_version",value:function(){if(this._sock.rQwait("version",12))return!1;var e=this._sock.rQshiftStr(12).substr(4,7);m("Server ProtocolVersion: "+e);var t=0;switch(e){case"000.000":t=1;break;case"003.003":case"003.006":case"003.889":this._rfb_version=3.3;break;case"003.007":this._rfb_version=3.7;break;case"003.008":case"004.000":case"004.001":case"005.000":this._rfb_version=3.8;break;default:return this._fail("Invalid server version "+e)}if(t){for(var i="ID:"+this._repeaterID;i.length<250;)i+="\0";return this._sock.send_string(i),!0}this._rfb_version>this._rfb_max_version&&(this._rfb_version=this._rfb_max_version);var s="00"+parseInt(this._rfb_version,10)+".00"+10*this._rfb_version%10;this._sock.send_string("RFB "+s+"\n"),p("Sent ProtocolVersion: "+s),this._rfb_init_state="Security"}},{key:"_negotiate_security",value:function(){function e(e,t){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}if(this._rfb_version>=3.7){var t=this._sock.rQshift8();if(this._sock.rQwait("security type",t,1))return!1;if(0===t)return this._rfb_init_state="SecurityReason",this._security_context="no security types",this._security_status=1,this._init_msg();var i=this._sock.rQshiftBytes(t);if(p("Server security types: "+i),e(1,i))this._rfb_auth_scheme=1;else if(e(22,i))this._rfb_auth_scheme=22;else if(e(16,i))this._rfb_auth_scheme=16;else{if(!e(2,i))return this._fail("Unsupported security types (types: "+i+")");this._rfb_auth_scheme=2}this._sock.send([this._rfb_auth_scheme])}else{if(this._sock.rQwait("security scheme",4))return!1;if(this._rfb_auth_scheme=this._sock.rQshift32(),0==this._rfb_auth_scheme)return this._rfb_init_state="SecurityReason",this._security_context="authentication scheme",this._security_status=1,this._init_msg()}return this._rfb_init_state="Authentication",p("Authenticating using scheme: "+this._rfb_auth_scheme),this._init_msg()}},{key:"_handle_security_reason",value:function(){if(this._sock.rQwait("reason length",4))return!1;var e=this._sock.rQshift32(),t="";if(e>0){if(this._sock.rQwait("reason",e,4))return!1;t=this._sock.rQshiftStr(e)}return""!==t?(this.dispatchEvent(new CustomEvent("securityfailure",{detail:{status:this._security_status,reason:t}})),this._fail("Security negotiation failed on "+this._security_context+" (reason: "+t+")")):(this.dispatchEvent(new CustomEvent("securityfailure",{detail:{status:this._security_status}})),this._fail("Security negotiation failed on "+this._security_context))}},{key:"_negotiate_xvp_auth",value:function(){if(!this._rfb_credentials.username||!this._rfb_credentials.password||!this._rfb_credentials.target)return this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password","target"]}})),!1;var e=String.fromCharCode(this._rfb_credentials.username.length)+String.fromCharCode(this._rfb_credentials.target.length)+this._rfb_credentials.username+this._rfb_credentials.target;return this._sock.send_string(e),this._rfb_auth_scheme=2,this._negotiate_authentication()}},{key:"_negotiate_std_vnc_auth",value:function(){if(this._sock.rQwait("auth challenge",16))return!1;if(!this._rfb_credentials.password)return this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["password"]}})),!1;var e=Array.prototype.slice.call(this._sock.rQshiftBytes(16)),i=t.genDES(this._rfb_credentials.password,e);return this._sock.send(i),this._rfb_init_state="SecurityResult",!0}},{key:"_negotiate_tight_tunnels",value:function(e){for(var t={vendor:"TGHT",signature:"NOTUNNEL"},i={},s=0;s<e;s++){var n=this._sock.rQshift32(),r=this._sock.rQshiftStr(4),a=this._sock.rQshiftStr(8);i[n]={vendor:r,signature:a}}return p("Server Tight tunnel types: "+i),i[1]&&"SICR"===i[1].vendor&&"SCHANNEL"===i[1].signature&&(p("Detected Siemens server. Assuming NOTUNNEL support."),i[0]={vendor:"TGHT",signature:"NOTUNNEL"}),i[0]?i[0].vendor!=t.vendor||i[0].signature!=t.signature?this._fail("Client's tunnel type had the incorrect vendor or signature"):(p("Selected tunnel type: "+t),this._sock.send([0,0,0,0]),!1):this._fail("Server wanted tunnels, but doesn't support the notunnel type")}},{key:"_negotiate_tight_auth",value:function(){if(!this._rfb_tightvnc){if(this._sock.rQwait("num tunnels",4))return!1;var e=this._sock.rQshift32();if(e>0&&this._sock.rQwait("tunnel capabilities",16*e,4))return!1;if(this._rfb_tightvnc=!0,e>0)return this._negotiate_tight_tunnels(e),!1}if(this._sock.rQwait("sub auth count",4))return!1;var t=this._sock.rQshift32();if(0===t)return this._rfb_init_state="SecurityResult",!0;if(this._sock.rQwait("sub auth capabilities",16*t,4))return!1;for(var i={STDVNOAUTH__:1,STDVVNCAUTH_:2},s=[],n=0;n<t;n++){this._sock.rQshift32();var r=this._sock.rQshiftStr(12);s.push(r)}for(var a in p("Server Tight authentication types: "+s),i)if(-1!=s.indexOf(a))switch(this._sock.send([0,0,0,i[a]]),p("Selected authentication type: "+a),a){case"STDVNOAUTH__":return this._rfb_init_state="SecurityResult",!0;case"STDVVNCAUTH_":return this._rfb_auth_scheme=2,this._init_msg();default:return this._fail("Unsupported tiny auth scheme (scheme: "+a+")")}return this._fail("No supported sub-auth types!")}},{key:"_negotiate_authentication",value:function(){switch(this._rfb_auth_scheme){case 1:return this._rfb_version>=3.8?(this._rfb_init_state="SecurityResult",!0):(this._rfb_init_state="ClientInitialisation",this._init_msg());case 22:return this._negotiate_xvp_auth();case 2:return this._negotiate_std_vnc_auth();case 16:return this._negotiate_tight_auth();default:return this._fail("Unsupported auth scheme (scheme: "+this._rfb_auth_scheme+")")}}},{key:"_handle_security_result",value:function(){if(this._sock.rQwait("VNC auth response ",4))return!1;var e=this._sock.rQshift32();return 0===e?(this._rfb_init_state="ClientInitialisation",p("Authentication OK"),this._init_msg()):this._rfb_version>=3.8?(this._rfb_init_state="SecurityReason",this._security_context="security result",this._security_status=e,this._init_msg()):(this.dispatchEvent(new CustomEvent("securityfailure",{detail:{status:e}})),this._fail("Security handshake failed"))}},{key:"_negotiate_server_init",value:function(){if(this._sock.rQwait("server initialization",24))return!1;var e=this._sock.rQshift16(),i=this._sock.rQshift16(),s=this._sock.rQshift8(),n=this._sock.rQshift8(),r=this._sock.rQshift8(),a=this._sock.rQshift8(),o=this._sock.rQshift16(),h=this._sock.rQshift16(),c=this._sock.rQshift16(),u=this._sock.rQshift8(),l=this._sock.rQshift8(),d=this._sock.rQshift8();this._sock.rQskipBytes(3);var _=this._sock.rQshift32();if(this._sock.rQwait("server init name",_,24))return!1;var f=k(this._sock.rQshiftStr(_));if(this._rfb_tightvnc){if(this._sock.rQwait("TightVNC extended server init header",8,24+_))return!1;var v=this._sock.rQshift16(),p=this._sock.rQshift16(),y=this._sock.rQshift16();this._sock.rQskipBytes(2);var w=16*(v+p+y);if(this._sock.rQwait("TightVNC extended server init header",w,32+_))return!1;this._sock.rQskipBytes(16*v),this._sock.rQskipBytes(16*p),this._sock.rQskipBytes(16*y)}return m("Screen: "+e+"x"+i+", bpp: "+s+", depth: "+n+", big_endian: "+r+", true_color: "+a+", red_max: "+o+", green_max: "+h+", blue_max: "+c+", red_shift: "+u+", green_shift: "+l+", blue_shift: "+d),this._setDesktopName(f),this._resize(e,i),this._viewOnly||this._keyboard.grab(),this._viewOnly||this._mouse.grab(),this._fb_depth=24,"Intel(r) AMT KVM"===this._fb_name&&(g("Intel AMT KVM only supports 8/16 bit depths. Using low color mode."),this._fb_depth=8),t.messages.pixelFormat(this._sock,this._fb_depth,!0),this._sendEncodings(),t.messages.fbUpdateRequest(this._sock,!1,0,0,this._fb_width,this._fb_height),this._updateConnectionState("connected"),!0}},{key:"_sendEncodings",value:function(){var e=[];e.push(_n.encodingCopyRect),24==this._fb_depth&&(e.push(_n.encodingTight),e.push(_n.encodingTightPNG),e.push(_n.encodingHextile),e.push(_n.encodingRRE)),e.push(_n.encodingRaw),e.push(_n.pseudoEncodingQualityLevel0+6),e.push(_n.pseudoEncodingCompressLevel0+2),e.push(_n.pseudoEncodingDesktopSize),e.push(_n.pseudoEncodingLastRect),e.push(_n.pseudoEncodingQEMUExtendedKeyEvent),e.push(_n.pseudoEncodingExtendedDesktopSize),e.push(_n.pseudoEncodingXvp),e.push(_n.pseudoEncodingFence),e.push(_n.pseudoEncodingContinuousUpdates),e.push(_n.pseudoEncodingDesktopName),24==this._fb_depth&&(e.push(_n.pseudoEncodingVMwareCursor),e.push(_n.pseudoEncodingCursor)),t.messages.clientEncodings(this._sock,e)}},{key:"_init_msg",value:function(){switch(this._rfb_init_state){case"ProtocolVersion":return this._negotiate_protocol_version();case"Security":return this._negotiate_security();case"Authentication":return this._negotiate_authentication();case"SecurityResult":return this._handle_security_result();case"SecurityReason":return this._handle_security_reason();case"ClientInitialisation":return this._sock.send([this._shared?1:0]),this._rfb_init_state="ServerInitialisation",!0;case"ServerInitialisation":return this._negotiate_server_init();default:return this._fail("Unknown init state (state: "+this._rfb_init_state+")")}}},{key:"_handle_set_colour_map_msg",value:function(){return p("SetColorMapEntries"),this._fail("Unexpected SetColorMapEntries message")}},{key:"_handle_server_cut_text",value:function(){if(p("ServerCutText"),this._sock.rQwait("ServerCutText header",7,1))return!1;this._sock.rQskipBytes(3);var e=this._sock.rQshift32();if(this._sock.rQwait("ServerCutText",e,8))return!1;var t=this._sock.rQshiftStr(e);return!!this._viewOnly||(this.dispatchEvent(new CustomEvent("clipboard",{detail:{text:t}})),!0)}},{key:"_handle_server_fence_msg",value:function(){if(this._sock.rQwait("ServerFence header",8,1))return!1;this._sock.rQskipBytes(3);var e=this._sock.rQshift32(),i=this._sock.rQshift8();if(this._sock.rQwait("ServerFence payload",i,9))return!1;i>64&&(g("Bad payload length ("+i+") in fence response"),i=64);var s=this._sock.rQshiftStr(i);return this._supportsFence=!0,e&1<<31?(e&=3,t.messages.clientFence(this._sock,e,s),!0):this._fail("Unexpected fence response")}},{key:"_handle_xvp_msg",value:function(){if(this._sock.rQwait("XVP version and message",3,1))return!1;this._sock.rQskipBytes(1);var e=this._sock.rQshift8(),t=this._sock.rQshift8();switch(t){case 0:y("XVP Operation Failed");break;case 1:this._rfb_xvp_ver=e,m("XVP extensions enabled (version "+this._rfb_xvp_ver+")"),this._setCapability("power",!0);break;default:this._fail("Illegal server XVP message (msg: "+t+")")}return!0}},{key:"_normal_msg",value:function(){var e,i,s;switch(e=this._FBU.rects>0?0:this._sock.rQshift8()){case 0:return(s=this._framebufferUpdate())&&!this._enabledContinuousUpdates&&t.messages.fbUpdateRequest(this._sock,!0,0,0,this._fb_width,this._fb_height),s;case 1:return this._handle_set_colour_map_msg();case 2:return p("Bell"),this.dispatchEvent(new CustomEvent("bell",{detail:{}})),!0;case 3:return this._handle_server_cut_text();case 150:return i=!this._supportsContinuousUpdates,this._supportsContinuousUpdates=!0,this._enabledContinuousUpdates=!1,i&&(this._enabledContinuousUpdates=!0,this._updateContinuousUpdates(),m("Enabling continuous updates.")),!0;case 248:return this._handle_server_fence_msg();case 250:return this._handle_xvp_msg();default:return this._fail("Unexpected server message (type "+e+")"),p("sock.rQslice(0, 30): "+this._sock.rQslice(0,30)),!0}}},{key:"_onFlush",value:function(){this._flushing=!1,this._sock.rQlen>0&&this._handle_message()}},{key:"_framebufferUpdate",value:function(){if(0===this._FBU.rects){if(this._sock.rQwait("FBU header",3,1))return!1;if(this._sock.rQskipBytes(1),this._FBU.rects=this._sock.rQshift16(),this._display.pending())return this._flushing=!0,this._display.flush(),!1}for(;this._FBU.rects>0;){if(null===this._FBU.encoding){if(this._sock.rQwait("rect header",12))return!1;var e=this._sock.rQshiftBytes(12);this._FBU.x=(e[0]<<8)+e[1],this._FBU.y=(e[2]<<8)+e[3],this._FBU.width=(e[4]<<8)+e[5],this._FBU.height=(e[6]<<8)+e[7],this._FBU.encoding=parseInt((e[8]<<24)+(e[9]<<16)+(e[10]<<8)+e[11],10)}if(!this._handleRect())return!1;this._FBU.rects--,this._FBU.encoding=null}return this._display.flip(),!0}},{key:"_handleRect",value:function(){switch(this._FBU.encoding){case _n.pseudoEncodingLastRect:return this._FBU.rects=1,!0;case _n.pseudoEncodingVMwareCursor:return this._handleVMwareCursor();case _n.pseudoEncodingCursor:return this._handleCursor();case _n.pseudoEncodingQEMUExtendedKeyEvent:try{void 0!==document.createEvent("keyboardEvent").code&&(this._qemuExtKeyEventSupported=!0)}catch(e){}return!0;case _n.pseudoEncodingDesktopName:return this._handleDesktopName();case _n.pseudoEncodingDesktopSize:return this._resize(this._FBU.width,this._FBU.height),!0;case _n.pseudoEncodingExtendedDesktopSize:return this._handleExtendedDesktopSize();default:return this._handleDataRect()}}},{key:"_handleVMwareCursor",value:function(){var e=this._FBU.x,t=this._FBU.y,i=this._FBU.width,s=this._FBU.height;if(this._sock.rQwait("VMware cursor encoding",1))return!1;var n,r=this._sock.rQshift8();this._sock.rQshift8();if(0==r){if(n=new Array(i*s*4),this._sock.rQwait("VMware cursor classic encoding",i*s*4*2,2))return!1;for(var a=new Array(i*s),o=0;o<i*s;o++)a[o]=this._sock.rQshift32();for(var h=new Array(i*s),c=0;c<i*s;c++)h[c]=this._sock.rQshift32();for(var u=0;u<i*s;u++)if(0==a[u]){var l=h[u],d=l>>8&255,_=l>>16&255,f=l>>24&255;n[4*u]=d,n[4*u+1]=_,n[4*u+2]=f,n[4*u+3]=255}else-256==(-256&a[u])?0==h[u]?(n[4*u]=0,n[4*u+1]=0,n[4*u+2]=0,n[4*u+3]=0):(h[u],n[4*u]=0,n[4*u+1]=0,n[4*u+2]=0,n[4*u+3]=255):(n[4*u]=0,n[4*u+1]=0,n[4*u+2]=0,n[4*u+3]=255)}else{if(1!=r)return g("The given cursor type is not supported: "+r+" given."),!1;if(this._sock.rQwait("VMware cursor alpha encoding",i*s*4,2))return!1;n=new Array(i*s*4);for(var v=0;v<i*s;v++){var p=this._sock.rQshift32();n[4*v]=p>>8&255,n[4*v+1]=p>>16&255,n[4*v+2]=p>>24&255,n[4*v+3]=255&p}}return this._updateCursor(n,e,t,i,s),!0}},{key:"_handleCursor",value:function(){var e=this._FBU.x,t=this._FBU.y,i=this._FBU.width,s=this._FBU.height,n=i*s*4,r=Math.ceil(i/8)*s,a=n+r;if(this._sock.rQwait("cursor encoding",a))return!1;for(var o=this._sock.rQshiftBytes(n),h=this._sock.rQshiftBytes(r),c=new Uint8Array(i*s*4),u=0,l=0;l<s;l++)for(var d=0;d<i;d++){var _=h[l*Math.ceil(i/8)+Math.floor(d/8)]<<d%8&128?255:0;c[u]=o[u+2],c[u+1]=o[u+1],c[u+2]=o[u],c[u+3]=_,u+=4}return this._updateCursor(c,e,t,i,s),!0}},{key:"_handleDesktopName",value:function(){if(this._sock.rQwait("DesktopName",4))return!1;var e=this._sock.rQshift32();if(this._sock.rQwait("DesktopName",e,4))return!1;var t=this._sock.rQshiftStr(e);return t=k(t),this._setDesktopName(t),!0}},{key:"_handleExtendedDesktopSize",value:function(){if(this._sock.rQwait("ExtendedDesktopSize",4))return!1;var e=this._sock.rQpeek8(),t=4+16*e;if(this._sock.rQwait("ExtendedDesktopSize",t))return!1;var i=!this._supportsSetDesktopSize;this._supportsSetDesktopSize=!0,i&&this._requestRemoteResize(),this._sock.rQskipBytes(1),this._sock.rQskipBytes(3);for(var s=0;s<e;s+=1)0===s?(this._screen_id=this._sock.rQshiftBytes(4),this._sock.rQskipBytes(2),this._sock.rQskipBytes(2),this._sock.rQskipBytes(2),this._sock.rQskipBytes(2),this._screen_flags=this._sock.rQshiftBytes(4)):this._sock.rQskipBytes(16);if(1===this._FBU.x&&0!==this._FBU.y){var n="";switch(this._FBU.y){case 1:n="Resize is administratively prohibited";break;case 2:n="Out of resources";break;case 3:n="Invalid screen layout";break;default:n="Unknown reason"}g("Server did not accept the resize request: "+n)}else this._resize(this._FBU.width,this._FBU.height);return!0}},{key:"_handleDataRect",value:function(){var e=this._decoders[this._FBU.encoding];if(!e)return this._fail("Unsupported encoding (encoding: "+this._FBU.encoding+")"),!1;try{return e.decodeRect(this._FBU.x,this._FBU.y,this._FBU.width,this._FBU.height,this._sock,this._display,this._fb_depth)}catch(t){return this._fail("Error decoding rect: "+t),!1}}},{key:"_updateContinuousUpdates",value:function(){this._enabledContinuousUpdates&&t.messages.enableContinuousUpdates(this._sock,!0,0,0,this._fb_width,this._fb_height)}},{key:"_resize",value:function(e,t){this._fb_width=e,this._fb_height=t,this._display.resize(this._fb_width,this._fb_height),this._updateClip(),this._updateScale(),this._updateContinuousUpdates()}},{key:"_xvpOp",value:function(e,i){this._rfb_xvp_ver<e||(m("Sending XVP operation "+i+" (version "+e+")"),t.messages.xvpOp(this._sock,e,i))}},{key:"_updateCursor",value:function(e,t,i,s,n){this._cursorImage={rgbaPixels:e,hotx:t,hoty:i,w:s,h:n},this._refreshCursor()}},{key:"_shouldShowDotCursor",value:function(){if(!this._showDotCursor)return!1;for(var e=3;e<this._cursorImage.rgbaPixels.length;e+=4)if(this._cursorImage.rgbaPixels[e])return!1;return!0}},{key:"_refreshCursor",value:function(){if("connected"===this._rfb_connection_state){var e=this._shouldShowDotCursor()?t.cursors.dot:this._cursorImage;this._cursor.change(e.rgbaPixels,e.hotx,e.hoty,e.w,e.h)}}},{key:"viewOnly",get:function(){return this._viewOnly},set:function(e){this._viewOnly=e,"connecting"!==this._rfb_connection_state&&"connected"!==this._rfb_connection_state||(e?(this._keyboard.ungrab(),this._mouse.ungrab()):(this._keyboard.grab(),this._mouse.grab()))}},{key:"capabilities",get:function(){return this._capabilities}},{key:"touchButton",get:function(){return this._mouse.touchButton},set:function(e){this._mouse.touchButton=e}},{key:"clipViewport",get:function(){return this._clipViewport},set:function(e){this._clipViewport=e,this._updateClip()}},{key:"scaleViewport",get:function(){return this._scaleViewport},set:function(e){this._scaleViewport=e,e&&this._clipViewport&&this._updateClip(),this._updateScale(),!e&&this._clipViewport&&this._updateClip()}},{key:"resizeSession",get:function(){return this._resizeSession},set:function(e){this._resizeSession=e,e&&this._requestRemoteResize()}},{key:"showDotCursor",get:function(){return this._showDotCursor},set:function(e){this._showDotCursor=e,this._refreshCursor()}},{key:"background",get:function(){return this._screen.style.background},set:function(e){this._screen.style.background=e}}],[{key:"genDES",value:function(e,t){var i=e.split("").map((function(e){return e.charCodeAt(0)}));return new ln(i).encrypt(t)}}]),t}(L);Gr.messages={keyEvent:function(e,t,i){var s=e._sQ,n=e._sQlen;s[n]=4,s[n+1]=i,s[n+2]=0,s[n+3]=0,s[n+4]=t>>24,s[n+5]=t>>16,s[n+6]=t>>8,s[n+7]=t,e._sQlen+=8,e.flush()},QEMUExtendedKeyEvent:function(e,t,i,s){var n=e._sQ,r=e._sQlen;n[r]=255,n[r+1]=0,n[r+2]=i>>8,n[r+3]=i,n[r+4]=t>>24,n[r+5]=t>>16,n[r+6]=t>>8,n[r+7]=t;var a=function(e){var t=255&s;return 224===s>>8&&t<127?128|t:e}(s);n[r+8]=a>>24,n[r+9]=a>>16,n[r+10]=a>>8,n[r+11]=a,e._sQlen+=12,e.flush()},pointerEvent:function(e,t,i,s){var n=e._sQ,r=e._sQlen;n[r]=5,n[r+1]=s,n[r+2]=t>>8,n[r+3]=t,n[r+4]=i>>8,n[r+5]=i,e._sQlen+=6,e.flush()},clientCutText:function(e,t){var i=e._sQ,s=e._sQlen;i[s]=6,i[s+1]=0,i[s+2]=0,i[s+3]=0;var n=t.length;i[s+4]=n>>24,i[s+5]=n>>16,i[s+6]=n>>8,i[s+7]=n,e._sQlen+=8;for(var r=0,a=n;a>0;){for(var o=Math.min(a,e._sQbufferSize-e._sQlen),h=0;h<o;h++)i[e._sQlen+h]=t.charCodeAt(r+h);e._sQlen+=o,e.flush(),a-=o,r+=o}},setDesktopSize:function(e,t,i,s,n){var r=e._sQ,a=e._sQlen;r[a]=251,r[a+1]=0,r[a+2]=t>>8,r[a+3]=t,r[a+4]=i>>8,r[a+5]=i,r[a+6]=1,r[a+7]=0,r[a+8]=s>>24,r[a+9]=s>>16,r[a+10]=s>>8,r[a+11]=s,r[a+12]=0,r[a+13]=0,r[a+14]=0,r[a+15]=0,r[a+16]=t>>8,r[a+17]=t,r[a+18]=i>>8,r[a+19]=i,r[a+20]=n>>24,r[a+21]=n>>16,r[a+22]=n>>8,r[a+23]=n,e._sQlen+=24,e.flush()},clientFence:function(e,t,i){var s=e._sQ,n=e._sQlen;s[n]=248,s[n+1]=0,s[n+2]=0,s[n+3]=0,s[n+4]=t>>24,s[n+5]=t>>16,s[n+6]=t>>8,s[n+7]=t;var r=i.length;s[n+8]=r;for(var a=0;a<r;a++)s[n+9+a]=i.charCodeAt(a);e._sQlen+=9+r,e.flush()},enableContinuousUpdates:function(e,t,i,s,n,r){var a=e._sQ,o=e._sQlen;a[o]=150,a[o+1]=t,a[o+2]=i>>8,a[o+3]=i,a[o+4]=s>>8,a[o+5]=s,a[o+6]=n>>8,a[o+7]=n,a[o+8]=r>>8,a[o+9]=r,e._sQlen+=10,e.flush()},pixelFormat:function(e,t,i){var s,n=e._sQ,r=e._sQlen;s=t>16?32:t>8?16:8;var a=Math.floor(t/3);n[r]=0,n[r+1]=0,n[r+2]=0,n[r+3]=0,n[r+4]=s,n[r+5]=t,n[r+6]=0,n[r+7]=i?1:0,n[r+8]=0,n[r+9]=(1<<a)-1,n[r+10]=0,n[r+11]=(1<<a)-1,n[r+12]=0,n[r+13]=(1<<a)-1,n[r+14]=2*a,n[r+15]=1*a,n[r+16]=0*a,n[r+17]=0,n[r+18]=0,n[r+19]=0,e._sQlen+=20,e.flush()},clientEncodings:function(e,t){var i=e._sQ,s=e._sQlen;i[s]=2,i[s+1]=0,i[s+2]=t.length>>8,i[s+3]=t.length;for(var n=s+4,r=0;r<t.length;r++){var a=t[r];i[n]=a>>24,i[n+1]=a>>16,i[n+2]=a>>8,i[n+3]=a,n+=4}e._sQlen+=n-s,e.flush()},fbUpdateRequest:function(e,t,i,s,n,r){var a=e._sQ,o=e._sQlen;"undefined"===typeof i&&(i=0),"undefined"===typeof s&&(s=0),a[o]=3,a[o+1]=t?1:0,a[o+2]=i>>8&255,a[o+3]=255&i,a[o+4]=s>>8&255,a[o+5]=255&s,a[o+6]=n>>8&255,a[o+7]=255&n,a[o+8]=r>>8&255,a[o+9]=255&r,e._sQlen+=10,e.flush()},xvpOp:function(e,t,i){var s=e._sQ,n=e._sQlen;s[n]=250,s[n+1]=0,s[n+2]=t,s[n+3]=i,e._sQlen+=4,e.flush()}},Gr.cursors={none:{rgbaPixels:new Uint8Array,w:0,h:0,hotx:0,hoty:0},dot:{rgbaPixels:new Uint8Array([255,255,255,255,0,0,0,255,255,255,255,255,0,0,0,255,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,255,255,255,255,255]),w:3,h:3,hotx:1,hoty:1}};var Xr=function(e){function t(e){var i;return Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).rfbTarget=n.a.createRef(),i.state={},i}return Object(l.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;for(e in this.rfb=new Gr(this.rfbTarget.current,this.props.roomClient.getControlUrl()),this.rfb.scaleViewport=!0,this.rfb.showDotCursor=!0,this.rfbListeners={connect:function(){return t.setState({connected:!0})},disconnect:function(){return t.setState({connected:!1})},credentialsrequired:function(e){return console.error("credentialsrequired",e)},desktopname:function(e){return console.log("desktopname",e)}},this.rfbListeners)this.rfb.addEventListener(e,this.rfbListeners[e])}},{key:"componentWillUnmount",value:function(){var e;for(e in this.rfb.disconnect(),this.rfbListeners)this.rfb.removeEventListener(e,this.rfbListeners[e])}},{key:"render",value:function(){var e=this.props.visible?"visible":"invisible",t=this.state.connected?"connected":"";return n.a.createElement("div",{className:"control-overlay-container ".concat(t)},n.a.createElement("div",{className:"control-overlay ".concat(e),ref:this.rfbTarget}))}}]),t}(s.Component),Yr=i(7),qr='video/webm; codecs="vp9,vorbis"',Zr=5,Jr=20,$r=1,ea=5,ta=function(e){function t(e){var i;if(Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).updateBuffer=function(e){i.sourceBufferErrored||(e&&i.pendingBuffers.push(e),i.sourceBuffer.updating?console.warn("sourcebuffer is updating"):i.pendingBuffers.length?i.sourceBuffer.appendBuffer(i.pendingBuffers.shift()):i.pruneBuffer())},i.pruneBuffer=function(){if(i.videoRef.current&&i.videoRef.current.buffered.length){var e=i.videoRef.current.buffered,t=e.start(e.length-1),s=e.end(e.length-1),n=e.start(0);if(s-i.videoRef.current.currentTime>Zr){var r=Math.max(t,s-$r);console.log("Seeking to ".concat(r)),i.videoRef.current.currentTime=r}if(s-n>Jr){var a=Math.max(0,Math.min(i.videoRef.current.currentTime-ea,s-ea));console.log("Removing buffers in range 0, ".concat(a)),i.sourceBuffer.remove(0,a)}}},i.state={status:"Connecting"},i.videoRef=n.a.createRef(),i.pendingBuffers=[],i.perfInfo=[],!MediaSource.isTypeSupported(qr))throw Error("MIME type ".concat(qr," not supported"));return i}return Object(l.a)(t,e),Object(h.a)(t,[{key:"connectStream",value:function(e){var t=this;if(this.ws)throw Error("already running");var i=this.ws=e.openStream();i.onopen=function(){t.setPlaybackState({status:"Connected"})},i.onerror=function(e){t.setPlaybackState({status:"Error: ".concat(e)})},i.onclose=function(){t.setPlaybackState({status:"Closed"})},i.onmessage=function(e){var i=e.data;t.sourceBuffer?(t.logPlayback(t.videoRef.current,i),t.updateBuffer(i)):console.log("no sourceBuffer yet"),t.setPlaybackState({lastMessageTime:performance.now()})};var s=this.videoSource=new MediaSource;s.addEventListener("sourceopen",(function(){t.sourceBuffer=s.addSourceBuffer(qr),t.sourceBuffer.onupdate=function(){return t.updateBuffer()},t.sourceBuffer.onerror=function(){return t.sourceBufferErrored=!0}})),this.videoRef.current.src=URL.createObjectURL(s)}},{key:"setPlaybackState",value:function(e){this.props.playbackState&&this.props.playbackState(e)}},{key:"closeStream",value:function(){if(!this.ws)throw Error("not running");this.ws.onopen=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.onmessage=null,this.ws.close(),this.ws=null}},{key:"logPlayback",value:function(e,t){e.error&&console.warn(e.error);var i=performance.now();this.perfInfo=this.perfInfo.filter((function(e){return i-e.time<5e3})),this.perfInfo.push({time:i,length:t.byteLength});var s,n=.001*(i-(this.perfInfo.length?this.perfInfo[0].time:0)),r=.001*this.perfInfo.map((function(e){return e.length})).reduce((function(e,t){return e+t}),0)/n,a=[];for(s=0;s<e.buffered.length;s++)a.push([e.buffered.start(s),e.buffered.end(s)]);console.log("Current playback time: ".concat(e.currentTime,". Available seek ahead: ").concat((e.seekable.length?e.seekable.end(0):0)-e.currentTime,". Buffered ranges: ").concat(a,". Avg bitrate: ").concat(r,"k/s.")),this.setPlaybackState({averageBitrate:r})}},{key:"componentDidMount",value:function(){this.connectStream(this.props.roomClient)}},{key:"componentWillUnmount",value:function(){this.closeStream()}},{key:"mediaErrorLog",value:function(e){var t;return{code:(t={},Object(Yr.a)(t,MediaError.MEDIA_ERR_ABORTED,"MEDIA_ERR_ABORTED"),Object(Yr.a)(t,MediaError.MEDIA_ERR_DECODE,"MEDIA_ERR_DECODE"),Object(Yr.a)(t,MediaError.MEDIA_ERR_NETWORK,"MEDIA_ERR_NETWORK"),Object(Yr.a)(t,MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED,"MEDIA_ERR_SRC_NOT_SUPPORTED"),t)[e.code]||"UNKNOWN: ".concat(e.code),message:e.message}}},{key:"render",value:function(){var e=this.videoRef.current&&this.videoRef.current.error,t=null;if(e){var i=this.mediaErrorLog(e);t=n.a.createElement("div",{className:"video-error"},n.a.createElement("div",null,"Error loading video stream"),n.a.createElement("div",null,"Code: "," "+i.code),n.a.createElement("div",null,"Message: "," "+i.message))}return n.a.createElement(n.a.Fragment,null,t,n.a.createElement("video",{autoPlay:!0,ref:this.videoRef,className:"video",controls:!0}))}}]),t}(s.Component),ia=-1,sa=0,na=function(e){function t(e){var i;return Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).enableControl=function(){i.setState({controlKey:sa++})},i.disableControl=function(){i.setState({controlKey:ia})},i.disableStream=function(){i.setState({streamKey:ia})},i.enableStream=function(){i.setState({streamKey:sa++})},i.isControlEnabled=function(){return i.state.controlKey!==ia},i.isStreamEnabled=function(){return i.state.streamKey!==ia},i.state={status:"Authenticating",streamKey:sa++,controlKey:ia},i.roomClient=new _(i.props.roomServer,window.location.protocol.startsWith("https")?"https":"http"),i}return Object(l.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.roomClient.logIn(this.props.roomCode).then((function(){return e.setState({authenticated:!0})})).catch((function(){return e.setState({status:"Couldn't authenticate, check code"})}))}},{key:"_getDesktopSize",value:function(){return{maxWidth:Number(Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_DESKTOP_WIDTH)||1920,maxHeight:Number(Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_DESKTOP_HEIGHT)||1080}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"room"},n.a.createElement("div",null,"Room server: ".concat(this.props.roomServer)),n.a.createElement("div",null,"status: ".concat(this.state.status)),n.a.createElement("div",null,"latest message time: ".concat(Number(.001*this.state.lastMessageTime).toFixed(3)," s")),n.a.createElement("div",null,"average stream bitrate: ".concat(Number(this.state.averageBitrate).toFixed(1)," kb/s")),n.a.createElement(ra,null),this.state.authenticated&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"room-controls"},n.a.createElement("button",{disabled:!this.isStreamEnabled(),onClick:this.disableStream},"Stop Video"),n.a.createElement("button",{onClick:this.enableStream},this.isStreamEnabled()?"Reset Video":"Start Video"),n.a.createElement("button",{disabled:this.isControlEnabled(),onClick:this.enableControl},"Grab Remote"),n.a.createElement("button",{disabled:!this.isControlEnabled(),onClick:this.disableControl},"Drop Remote")),n.a.createElement("div",{style:this._getDesktopSize(),className:"desktop"},this.isStreamEnabled()&&n.a.createElement(ta,{key:this.state.streamKey,roomClient:this.roomClient,playbackState:function(t){return e.setState(t)}}),this.isControlEnabled()&&n.a.createElement(Xr,{key:this.state.controlKey,roomClient:this.roomClient}))))}}]),t}(s.Component),ra=function(e){function t(e){var i;return Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).updateTime=function(){i.setState({now:new Date}),i.tid=setTimeout(i.updateTime,500)},i.state={now:new Date},i}return Object(l.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.updateTime()}},{key:"componentWillUnmount",value:function(){this.tid&&clearTimeout(this.tid)}},{key:"timeDigit",value:function(e){var t=String(e);return 1===t.length?"0".concat(t):t}},{key:"render",value:function(){var e=this.state.now,t="".concat(this.timeDigit(e.getHours()),":").concat(this.timeDigit(e.getMinutes()),":").concat(this.timeDigit(e.getSeconds()));return n.a.createElement("div",null,"Current time: ",t)}}]),t}(s.Component),aa=function(e){function t(e){var i;return Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},i}return Object(l.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e,t=this;return e=void 0!==this.state.key?n.a.createElement(na,{roomServer:this.state.roomServer,roomCode:this.state.roomCode,key:this.state.key}):n.a.createElement("div",{className:"room"}),n.a.createElement("div",{className:"App"},n.a.createElement(d,{initiallyOpen:!0,connect:function(e){var i=e.roomServer,s=e.roomCode,n=e.key;return t.setState({roomServer:i,roomCode:s,key:n})}}),e)}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(n.a.createElement(aa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[11,1,2]]]);
//# sourceMappingURL=main.7ad3a2d3.chunk.js.map